<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>the log of study from jy</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2021-08-15T02:53:07.647Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>Jiang Yi</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>nodejs-koa</title>
    <link href="http://example.com/2021/08/15/nodejs-koa/"/>
    <id>http://example.com/2021/08/15/nodejs-koa/</id>
    <published>2021-08-15T02:32:23.327Z</published>
    <updated>2021-08-15T02:53:07.647Z</updated>
    
    <content type="html"><![CDATA[<h1 id="NodeJs框架-Koa"><a href="#NodeJs框架-Koa" class="headerlink" title="NodeJs框架 Koa"></a>NodeJs框架 Koa</h1><h2 id="一、Koa简介"><a href="#一、Koa简介" class="headerlink" title="一、Koa简介"></a>一、Koa简介</h2><p>文档地址：<a href="https://koa.bootcss.com/">https://koa.bootcss.com</a><br> 是一个新的 web 框架，由 Express 幕后的原班人马打造， 致力于成为 web 应用和 API 开发领域中的一个更小、更富有表现力、更健壮的基石。 通过利用 async 函数，Koa 帮你丢弃回调函数，并有力地增强错误处理。 Koa 并没有捆绑任何中间件， 而是提供了一套优雅的方法，帮助您快速而愉快地编写服务端应用程序。</p><h2 id="二、Koa之hello-world"><a href="#二、Koa之hello-world" class="headerlink" title="二、Koa之hello world"></a>二、Koa之hello world</h2><h3 id="（1）新建koa-demo文件夹，初始化package-json"><a href="#（1）新建koa-demo文件夹，初始化package-json" class="headerlink" title="（1）新建koa-demo文件夹，初始化package.json"></a>（1）新建koa-demo文件夹，初始化package.json</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br></pre></td></tr></table></figure><h3 id="（2）安装Koa模块"><a href="#（2）安装Koa模块" class="headerlink" title="（2）安装Koa模块"></a>（2）安装Koa模块</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i koa -S</span><br></pre></td></tr></table></figure><h3 id="（3）在项目根目录新建app-js，app-js代码如下："><a href="#（3）在项目根目录新建app-js，app-js代码如下：" class="headerlink" title="（3）在项目根目录新建app.js，app.js代码如下："></a>（3）在项目根目录新建app.js，app.js代码如下：</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入koa模块</span></span><br><span class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">&#x27;koa&#x27;</span>);</span><br><span class="line"><span class="comment">// 创建koa的实例app</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa();</span><br><span class="line"></span><br><span class="line">app.use(<span class="keyword">async</span> ctx =&gt; &#123;</span><br><span class="line">    ctx.body = <span class="string">&quot;Hello World&quot;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 监听端口</span></span><br><span class="line">app.listen(<span class="number">3000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;服务器已启动，http://localhost:3000&quot;</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="（3）使用node命令启动服务器，并访问本地地址端口3000"><a href="#（3）使用node命令启动服务器，并访问本地地址端口3000" class="headerlink" title="（3）使用node命令启动服务器，并访问本地地址端口3000"></a>（3）使用node命令启动服务器，并访问本地地址端口3000</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node app</span><br></pre></td></tr></table></figure><h2 id="三、服务器自动重新部署"><a href="#三、服务器自动重新部署" class="headerlink" title="三、服务器自动重新部署"></a>三、服务器自动重新部署</h2><h3 id="（1）、-nodejs开发辅助工具"><a href="#（1）、-nodejs开发辅助工具" class="headerlink" title="（1）、 nodejs开发辅助工具"></a>（1）、 nodejs开发辅助工具</h3><p>修改代码后，需要重新启动 Koa应用，所做的修改才能生效。若之后的每次代码修改都要重复这样的操作，势必会影响开发效率，使用了nodemon后，它会监测项目中的所有文件，一旦发现文件有改动，会自动重启应用</p><h3 id="（2）全局安装nodemon"><a href="#（2）全局安装nodemon" class="headerlink" title="（2）全局安装nodemon"></a>（2）全局安装nodemon</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i nodemon -g</span><br></pre></td></tr></table></figure><h3 id="（3）启动服务的时候用nodemon-app-js-代替node-app-js"><a href="#（3）启动服务的时候用nodemon-app-js-代替node-app-js" class="headerlink" title="（3）启动服务的时候用nodemon app.js 代替node app.js"></a>（3）启动服务的时候用nodemon app.js 代替node app.js</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nodemon app</span><br></pre></td></tr></table></figure><h2 id="四、Koa中间件"><a href="#四、Koa中间件" class="headerlink" title="四、Koa中间件"></a>四、Koa中间件</h2><h3 id="1）什么是koa中间件"><a href="#1）什么是koa中间件" class="headerlink" title="(1）什么是koa中间件"></a>(1）什么是koa中间件</h3><p>      koa对网络请求采用了中间件的形式处理,中间件可以介入请求和相应的处理,是一个轻量级的模块,每个中间负责完成某个特定的功能。中间件的通过next函数联系,执行next()后会将控制权交给下一个中间件,如果没有中间件没有执行next后将会沿路折返,将控制权交换给前一个中间件。<br>      每个中间件都是一个函数(不是函数将报错)，接收两个参数，第一个是上下文对象，另一个是函数</p><h3 id="（2）中间件的使用"><a href="#（2）中间件的使用" class="headerlink" title="（2）中间件的使用"></a>（2）中间件的使用</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">app.use(<span class="function">(<span class="params">ctx, next</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 在ctx上放入username,后面的所有请求的ctx里都会有username这个变量</span></span><br><span class="line">        ctx.username = <span class="string">&#x27;我是Grayly&#x27;</span>;</span><br><span class="line">        <span class="comment">// 处理完之后放行,不使用next()的话,程序会被挂起来不动了</span></span><br><span class="line">        next();</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure><h3 id="3）中间件有先后顺序"><a href="#3）中间件有先后顺序" class="headerlink" title="(3）中间件有先后顺序"></a>(3）中间件有先后顺序</h3><h2 id="五、Koa路由配置"><a href="#五、Koa路由配置" class="headerlink" title="五、Koa路由配置"></a>五、Koa路由配置</h2><h3 id="（1）安装koa-router"><a href="#（1）安装koa-router" class="headerlink" title="（1）安装koa-router"></a>（1）安装koa-router</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i koa-router -D</span><br></pre></td></tr></table></figure><h3 id="（2）导入koa-router模块并实例化"><a href="#（2）导入koa-router模块并实例化" class="headerlink" title="（2）导入koa-router模块并实例化"></a>（2）导入koa-router模块并实例化</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入koa-router模块</span></span><br><span class="line">    <span class="keyword">const</span> Router = <span class="built_in">require</span>(<span class="string">&#x27;koa-router&#x27;</span>);</span><br><span class="line">    <span class="comment">// 创建koa-router的实例router</span></span><br><span class="line">    <span class="keyword">const</span> router = <span class="keyword">new</span> Router();</span><br></pre></td></tr></table></figure><h3 id="（3）配置，并访问本地地址端口3000"><a href="#（3）配置，并访问本地地址端口3000" class="headerlink" title="（3）配置，并访问本地地址端口3000"></a>（3）配置，并访问本地地址端口3000</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">router.get(<span class="string">&#x27;/&#x27;</span>, <span class="function"><span class="params">ctx</span> =&gt;</span> &#123;</span><br><span class="line">        ctx.body = <span class="string">&quot;哈哈哈&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line">    app.use(router.routes());</span><br></pre></td></tr></table></figure><h3 id="（4）koa-router-提供了-get、-post、-put-和-del-接口来处理各种请求，但实际业务上，我们大部分只会接触到-POST-和-GET，所以接下来只针对这两种请求类型来说明。"><a href="#（4）koa-router-提供了-get、-post、-put-和-del-接口来处理各种请求，但实际业务上，我们大部分只会接触到-POST-和-GET，所以接下来只针对这两种请求类型来说明。" class="headerlink" title="（4）koa-router 提供了 .get、.post、.put 和 .del 接口来处理各种请求，但实际业务上，我们大部分只会接触到 POST 和 GET，所以接下来只针对这两种请求类型来说明。"></a>（4）koa-router 提供了 .get、.post、.put 和 .del 接口来处理各种请求，但实际业务上，我们大部分只会接触到 POST 和 GET，所以接下来只针对这两种请求类型来说明。</h3><h4 id="（4-1）get：用于接收GET请求"><a href="#（4-1）get：用于接收GET请求" class="headerlink" title="（4.1）get：用于接收GET请求"></a>（4.1）get：用于接收GET请求</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">router.get(<span class="string">&#x27;/get&#x27;</span>, <span class="function"><span class="params">ctx</span> =&gt;</span> &#123;</span><br><span class="line">        ctx.body = <span class="string">&quot;哈哈哈&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line">    app.use(router.routes());</span><br></pre></td></tr></table></figure><h4 id="（4-2）post：用于接收POST请求"><a href="#（4-2）post：用于接收POST请求" class="headerlink" title="（4.2）post：用于接收POST请求"></a>（4.2）post：用于接收POST请求</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">router.post(<span class="string">&#x27;/&#x27;</span>, <span class="function"><span class="params">ctx</span> =&gt;</span> &#123;</span><br><span class="line">        ctx.body = <span class="string">&quot;哈哈哈&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line">    app.use(router.routes());</span><br></pre></td></tr></table></figure><h4 id="（4-3）all：用于接收GET与POST请求"><a href="#（4-3）all：用于接收GET与POST请求" class="headerlink" title="（4.3）all：用于接收GET与POST请求"></a>（4.3）all：用于接收GET与POST请求</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">router.all(<span class="string">&#x27;/&#x27;</span>, <span class="function"><span class="params">ctx</span> =&gt;</span> &#123;</span><br><span class="line">        ctx.body = <span class="string">&quot;哈哈哈&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line">    app.use(router.routes());</span><br></pre></td></tr></table></figure><h3 id="（5）获取请求参数"><a href="#（5）获取请求参数" class="headerlink" title="（5）获取请求参数"></a>（5）获取请求参数</h3><h4 id="（5-1）获取get请求参数：ctx-query"><a href="#（5-1）获取get请求参数：ctx-query" class="headerlink" title="（5.1）获取get请求参数：ctx.query"></a>（5.1）获取get请求参数：ctx.query</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">router.get(<span class="string">&#x27;/get&#x27;</span>, <span class="function"><span class="params">ctx</span> =&gt;</span> &#123;</span><br><span class="line">         ctx.body = ctx.query</span><br><span class="line">     &#125;)</span><br></pre></td></tr></table></figure><h4 id="（5-2）获取post请求参数：ctx-request-body"><a href="#（5-2）获取post请求参数：ctx-request-body" class="headerlink" title="（5.2）获取post请求参数：ctx.request.body"></a>（5.2）获取post请求参数：ctx.request.body</h4><p>当用 post 方式请求时，我们会遇到一个问题：post 请求通常都会通过表单或 JSON 形式发送，而无论是 Node 还是 Koa，都 没有提供 解析 post 请求参数的功能。<br>获取post请求需要使用koa-body模块</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i koa-body --save</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">router.get(<span class="string">&#x27;/get&#x27;</span>, <span class="function"><span class="params">ctx</span> =&gt;</span> &#123;</span><br><span class="line">        ctx.body = ctx.request.body</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure><h4 id="（5-3）使用中间件封装请求参数：把get请求参数和post请求参数都放入params对象"><a href="#（5-3）使用中间件封装请求参数：把get请求参数和post请求参数都放入params对象" class="headerlink" title="（5.3）使用中间件封装请求参数：把get请求参数和post请求参数都放入params对象"></a>（5.3）使用中间件封装请求参数：把get请求参数和post请求参数都放入params对象</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">app.use(<span class="function">(<span class="params">ctx, next</span>) =&gt;</span> &#123;</span><br><span class="line">          ctx.params = &#123;</span><br><span class="line">              ...ctx.query,</span><br><span class="line">              ...ctx.request.body</span><br><span class="line">          &#125;</span><br><span class="line">          next();</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="六、设置静态目录koa-static"><a href="#六、设置静态目录koa-static" class="headerlink" title="六、设置静态目录koa-static"></a>六、设置静态目录koa-static</h2><h3 id="（1）在目录中创建目录public，在public下创建文件demo-html，访问http-localhost-3000-public-demo-html是无法访问得到，因为我们还没有设置静态资源目录-设置静态资源目录要用到koa-static模块"><a href="#（1）在目录中创建目录public，在public下创建文件demo-html，访问http-localhost-3000-public-demo-html是无法访问得到，因为我们还没有设置静态资源目录-设置静态资源目录要用到koa-static模块" class="headerlink" title="（1）在目录中创建目录public，在public下创建文件demo.html，访问http://localhost:3000/public/demo.html是无法访问得到，因为我们还没有设置静态资源目录,设置静态资源目录要用到koa-static模块"></a>（1）在目录中创建目录public，在public下创建文件demo.html，访问<a href="http://localhost:3000/public/demo.html%E6%98%AF%E6%97%A0%E6%B3%95%E8%AE%BF%E9%97%AE%E5%BE%97%E5%88%B0%EF%BC%8C%E5%9B%A0%E4%B8%BA%E6%88%91%E4%BB%AC%E8%BF%98%E6%B2%A1%E6%9C%89%E8%AE%BE%E7%BD%AE%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E7%9B%AE%E5%BD%95,%E8%AE%BE%E7%BD%AE%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E7%9B%AE%E5%BD%95%E8%A6%81%E7%94%A8%E5%88%B0koa-static%E6%A8%A1%E5%9D%97">http://localhost:3000/public/demo.html是无法访问得到，因为我们还没有设置静态资源目录,设置静态资源目录要用到koa-static模块</a></h3><h3 id="（2）安装koa-static"><a href="#（2）安装koa-static" class="headerlink" title="（2）安装koa-static"></a>（2）安装koa-static</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i koa-static -D</span><br></pre></td></tr></table></figure><h3 id="（3）在app-js里加入如下代码"><a href="#（3）在app-js里加入如下代码" class="headerlink" title="（3）在app.js里加入如下代码"></a>（3）在app.js里加入如下代码</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> koaStatic = <span class="built_in">require</span>(<span class="string">&#x27;koa-static&#x27;</span>);</span><br><span class="line">app.use(koaStatic(__dirname + <span class="string">&#x27;/public&#x27;</span>));</span><br></pre></td></tr></table></figure><h2 id="七、使用模板引擎-koa-views"><a href="#七、使用模板引擎-koa-views" class="headerlink" title="七、使用模板引擎{koa-views"></a>七、使用模板引擎{koa-views</h2><h3 id="（1）安装koa-views"><a href="#（1）安装koa-views" class="headerlink" title="（1）安装koa-views"></a>（1）安装koa-views</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm i koa-views -D</span><br><span class="line">npm i underscore -D</span><br></pre></td></tr></table></figure><h3 id="（2）模板编写：在根目录创建views目录，在views目录下创建tpl-html-代码如下"><a href="#（2）模板编写：在根目录创建views目录，在views目录下创建tpl-html-代码如下" class="headerlink" title="（2）模板编写：在根目录创建views目录，在views目录下创建tpl.html,代码如下"></a>（2）模板编写：在根目录创建views目录，在views目录下创建tpl.html,代码如下</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&lt;%=title %&gt;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="（3）在app-js配置模板引擎中间件"><a href="#（3）在app-js配置模板引擎中间件" class="headerlink" title="（3）在app.js配置模板引擎中间件"></a>（3）在app.js配置模板引擎中间件</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> views = <span class="built_in">require</span>(<span class="string">&quot;koa-views&quot;</span>);</span><br><span class="line">app.use(views(path.join(__dirname, <span class="string">&quot;views&quot;</span>), &#123;</span><br><span class="line">  <span class="attr">map</span>: &#123;</span><br><span class="line">    <span class="attr">html</span>: <span class="string">&#x27;underscore&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure><h3 id="（4）使用模板引擎"><a href="#（4）使用模板引擎" class="headerlink" title="（4）使用模板引擎"></a>（4）使用模板引擎</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">router.get(<span class="string">&quot;/html&quot;</span>, <span class="keyword">async</span> ctx =&gt; &#123;</span><br><span class="line">    <span class="keyword">await</span> ctx.render(<span class="string">&quot;tpl&quot;</span>, &#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;Grayly&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="八、Vue-SSR（vue服务器渲染）"><a href="#八、Vue-SSR（vue服务器渲染）" class="headerlink" title="八、Vue SSR（vue服务器渲染）"></a>八、Vue SSR（vue服务器渲染）</h2><h3 id="（1）安装vue和vue服务器渲染插件"><a href="#（1）安装vue和vue服务器渲染插件" class="headerlink" title="（1）安装vue和vue服务器渲染插件"></a>（1）安装vue和vue服务器渲染插件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vue vue-server-renderer -S</span><br></pre></td></tr></table></figure><h3 id="（2）渲染"><a href="#（2）渲染" class="headerlink" title="（2）渲染"></a>（2）渲染</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">router.get(<span class="string">&#x27;/ssr&#x27;</span>, <span class="keyword">async</span> ctx =&gt; &#123;</span><br><span class="line">    第 <span class="number">1</span> 步：创建一个 Vue 实例</span><br><span class="line">    <span class="keyword">const</span> Vue = <span class="built_in">require</span>(<span class="string">&#x27;vue&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">        <span class="attr">template</span>: <span class="string">`&lt;div&gt;Hello World&lt;/div&gt;`</span></span><br><span class="line">    &#125;)</span><br><span class="line">    第 <span class="number">2</span> 步：创建一个 renderer</span><br><span class="line">    <span class="keyword">const</span> renderer = <span class="built_in">require</span>(<span class="string">&#x27;vue-server-renderer&#x27;</span>).createRenderer();</span><br><span class="line">    第 <span class="number">3</span> 步：将 Vue 实例渲染为 HTML</span><br><span class="line">    renderer.renderToString(app, <span class="function">(<span class="params">err, html</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) <span class="keyword">throw</span> err</span><br><span class="line">        <span class="built_in">console</span>.log(html)</span><br><span class="line">        ctx.body = html;</span><br><span class="line">        <span class="comment">// =&gt; &lt;div data-server-rendered=&quot;true&quot;&gt;Hello World&lt;/div&gt;</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="九、Koa跨域设置"><a href="#九、Koa跨域设置" class="headerlink" title="九、Koa跨域设置"></a>九、Koa跨域设置</h2><p>使用中间件编写跨域设置</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">app.use(<span class="function">(<span class="params">ctx, next</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="comment">// 设置允许跨域</span></span><br><span class="line">       ctx.set(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br><span class="line">       ctx.set(<span class="string">&quot;Access-Control-Allow-Methods&quot;</span>, <span class="string">&quot;PUT, POST, GET, DELETE, OPTIONS&quot;</span>);</span><br><span class="line">       <span class="comment">// 请求头设置</span></span><br><span class="line">       ctx.set(</span><br><span class="line">           <span class="string">&quot;Access-Control-Allow-Headers&quot;</span>,</span><br><span class="line">           <span class="string">`Content-Type, Content-Length, Authorization, Accept, X-Requested-With , yourHeaderFeild,x-token,sessionToken,token`</span></span><br><span class="line">       );</span><br><span class="line">       <span class="keyword">if</span> (ctx.method == <span class="string">&quot;OPTIONS&quot;</span>) &#123;</span><br><span class="line">           ctx.body = <span class="number">200</span>;</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">           next();</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;NodeJs框架-Koa&quot;&gt;&lt;a href=&quot;#NodeJs框架-Koa&quot; class=&quot;headerlink&quot; title=&quot;NodeJs框架 Koa&quot;&gt;&lt;/a&gt;NodeJs框架 Koa&lt;/h1&gt;&lt;h2 id=&quot;一、Koa简介&quot;&gt;&lt;a href=&quot;#一、Koa简</summary>
      
    
    
    
    <category term="教程" scheme="http://example.com/categories/%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="nodejs" scheme="http://example.com/tags/nodejs/"/>
    
  </entry>
  
  <entry>
    <title>m1-macbook-use</title>
    <link href="http://example.com/2021/08/05/m1-macbook-use/"/>
    <id>http://example.com/2021/08/05/m1-macbook-use/</id>
    <published>2021-08-04T17:01:57.950Z</published>
    <updated>2021-08-04T17:12:36.597Z</updated>
    
    <content type="html"><![CDATA[<h2 id="JDK-配置"><a href="#JDK-配置" class="headerlink" title="JDK 配置"></a>JDK 配置</h2><p>目前 Zulu JDK 支持 M1芯片，下载：<a href="https://www.azul.com/downloads/?package=jdk#download-openjdk">下载地址</a><br>下载后点击安装，在控制台输入java -version</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br><span class="line">openjdk version <span class="string">&quot;16.0.2&quot;</span> 2021-07-20</span><br><span class="line">OpenJDK Runtime Environment Zulu16.32+15-CA (build 16.0.2+7)</span><br><span class="line">OpenJDK 64-Bit Server VM Zulu16.32+15-CA (build 16.0.2+7, mixed mode)</span><br></pre></td></tr></table></figure><h2 id="多版本-JDK"><a href="#多版本-JDK" class="headerlink" title="多版本 JDK"></a>多版本 JDK</h2><p>下载不同版本安装即可，Zulu JDK默认安装在/Library/Java/JavaVirtualMachines目录下，配置 JAVA_HOME切换 JDK版本, 修改~/.zshrc文件,(Mac M1 2020 版默认使用的是zsh)没有创建一个, 将配置加入到文件末尾</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> JAVA_HOME=/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home</span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/Library/Java/JavaVirtualMachines/zulu-11.jdk/Contents/Home</span><br></pre></td></tr></table></figure><h2 id="MAVEN-配置"><a href="#MAVEN-配置" class="headerlink" title="MAVEN 配置"></a>MAVEN 配置</h2><p>下载maven, 解压后移动到 /opt目录下（不移动到/opt下也行），配置MAVEN_HOME, 修改~/.zshrc文件， 将配置加入到文件末尾<br><a href="https://maven.apache.org/download.cgi">下载地址</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> MAVEN_HOME=/opt/apache-maven-3.6.3</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$MAVEN_HOME</span>/bin</span><br></pre></td></tr></table></figure><p>控制台输入mvn -version</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Apache Maven 3.6.3 (cecedd343002696d0abb50b32b541b8a6ba2883f)</span><br><span class="line">Maven home: /opt/apache-maven-3.6.3</span><br><span class="line">Java version: 11.0.10, vendor: Azul Systems, Inc., runtime: /Library/Java/JavaVirtualMachines/zulu-11.jdk/Contents/Home</span><br><span class="line">Default locale: zh_CN_<span class="comment">#Hans, platform encoding: UTF-8</span></span><br><span class="line">OS name: <span class="string">&quot;mac os x&quot;</span>, version: <span class="string">&quot;11.2&quot;</span>, arch: <span class="string">&quot;aarch64&quot;</span>, family: <span class="string">&quot;Mac&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;JDK-配置&quot;&gt;&lt;a href=&quot;#JDK-配置&quot; class=&quot;headerlink&quot; title=&quot;JDK 配置&quot;&gt;&lt;/a&gt;JDK 配置&lt;/h2&gt;&lt;p&gt;目前 Zulu JDK 支持 M1芯片，下载：&lt;a href=&quot;https://www.azul.com/d</summary>
      
    
    
    
    <category term="技巧" scheme="http://example.com/categories/%E6%8A%80%E5%B7%A7/"/>
    
    
    <category term="m1-macbook" scheme="http://example.com/tags/m1-macbook/"/>
    
  </entry>
  
  <entry>
    <title>nginx-use</title>
    <link href="http://example.com/2021/07/22/nginx-using-method/"/>
    <id>http://example.com/2021/07/22/nginx-using-method/</id>
    <published>2021-07-21T16:34:07.654Z</published>
    <updated>2021-08-15T01:51:28.590Z</updated>
    
    <content type="html"><![CDATA[<h1 id="nginx使用教程"><a href="#nginx使用教程" class="headerlink" title="nginx使用教程"></a>nginx使用教程</h1><p>本nginx是在Ubuntu20.04系统下运行的<br>nginx version: nginx/1.18.0 (Ubuntu)</p><h2 id="安装："><a href="#安装：" class="headerlink" title="安装："></a>安装：</h2><p>安装依赖:</p><h3 id="首先使用dpkg命令查看自己需要的软件是否安装"><a href="#首先使用dpkg命令查看自己需要的软件是否安装" class="headerlink" title="首先使用dpkg命令查看自己需要的软件是否安装"></a>首先使用dpkg命令查看自己需要的软件是否安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dpkg -l | grep zlib</span><br></pre></td></tr></table></figure><h3 id="解决依赖包openssl安装，命令"><a href="#解决依赖包openssl安装，命令" class="headerlink" title="解决依赖包openssl安装，命令"></a>解决依赖包openssl安装，命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install openssl libssl-dev</span><br></pre></td></tr></table></figure><h3 id="解决依赖包pcre安装，命令"><a href="#解决依赖包pcre安装，命令" class="headerlink" title="解决依赖包pcre安装，命令"></a>解决依赖包pcre安装，命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install libpcre3 libpcre3-dev</span><br></pre></td></tr></table></figure><h3 id="解决依赖包zlib安装，命令"><a href="#解决依赖包zlib安装，命令" class="headerlink" title="解决依赖包zlib安装，命令"></a>解决依赖包zlib安装，命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install zlib1g-dev</span><br></pre></td></tr></table></figure><h2 id="ubuntu下开启-关闭防火墙-及端口-命令"><a href="#ubuntu下开启-关闭防火墙-及端口-命令" class="headerlink" title="ubuntu下开启/关闭防火墙 及端口 - 命令"></a>ubuntu下开启/关闭防火墙 及端口 - 命令</h2><h3 id="查看端口开启状态"><a href="#查看端口开启状态" class="headerlink" title="查看端口开启状态"></a>查看端口开启状态</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ufw status</span><br></pre></td></tr></table></figure><h3 id="开启某个端口，比如我开启的是8381"><a href="#开启某个端口，比如我开启的是8381" class="headerlink" title="开启某个端口，比如我开启的是8381"></a>开启某个端口，比如我开启的是8381</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ufw allow 8381</span><br></pre></td></tr></table></figure><h3 id="开启防火墙"><a href="#开启防火墙" class="headerlink" title="开启防火墙"></a>开启防火墙</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ufw <span class="built_in">enable</span></span><br></pre></td></tr></table></figure><h3 id="关闭防火墙"><a href="#关闭防火墙" class="headerlink" title="关闭防火墙"></a>关闭防火墙</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ufw <span class="built_in">disable</span></span><br></pre></td></tr></table></figure><h3 id="重启防火墙"><a href="#重启防火墙" class="headerlink" title="重启防火墙"></a>重启防火墙</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ufw reload</span><br></pre></td></tr></table></figure><h3 id="禁止外部某个端口比如80"><a href="#禁止外部某个端口比如80" class="headerlink" title="禁止外部某个端口比如80"></a>禁止外部某个端口比如80</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ufw delete allow 80</span><br></pre></td></tr></table></figure><h3 id="查看端口ip"><a href="#查看端口ip" class="headerlink" title="查看端口ip"></a>查看端口ip</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -ltn</span><br></pre></td></tr></table></figure><h3 id="对于阿里轻量服务器的端口"><a href="#对于阿里轻量服务器的端口" class="headerlink" title="对于阿里轻量服务器的端口"></a>对于阿里轻量服务器的端口</h3><p>阿里轻量服务器的端口在机器上开放端口以后，还要在阿里的控制台进行再一次的端口设置，阿里有两层服务器安全设置，设置好以后差不多开启对应端口上的服务就可以使用了</p><h3 id="另一个防火墙设置命令"><a href="#另一个防火墙设置命令" class="headerlink" title="另一个防火墙设置命令"></a>另一个防火墙设置命令</h3><h4 id="查看已经开放的端口"><a href="#查看已经开放的端口" class="headerlink" title="查看已经开放的端口"></a>查看已经开放的端口</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --list-ports</span><br></pre></td></tr></table></figure><h4 id="开放端口"><a href="#开放端口" class="headerlink" title="开放端口"></a>开放端口</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=80/tcp --permanent</span><br></pre></td></tr></table></figure><h4 id="重启防火墙-1"><a href="#重启防火墙-1" class="headerlink" title="重启防火墙"></a>重启防火墙</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl reload firewalld</span><br></pre></td></tr></table></figure><h4 id="查看firewalld状态，发现当前是dead状态，即防火墙未开启"><a href="#查看firewalld状态，发现当前是dead状态，即防火墙未开启" class="headerlink" title="查看firewalld状态，发现当前是dead状态，即防火墙未开启"></a>查看firewalld状态，发现当前是dead状态，即防火墙未开启</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status firewalld</span><br></pre></td></tr></table></figure><h4 id="开启防火墙，没有任何提示即开启成功。"><a href="#开启防火墙，没有任何提示即开启成功。" class="headerlink" title="开启防火墙，没有任何提示即开启成功。"></a>开启防火墙，没有任何提示即开启成功。</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start firewalld</span><br></pre></td></tr></table></figure><h4 id="如果要关闭防火墙设置，可能通过systemctl-stop-firewalld这条指令来关闭该功能"><a href="#如果要关闭防火墙设置，可能通过systemctl-stop-firewalld这条指令来关闭该功能" class="headerlink" title="如果要关闭防火墙设置，可能通过systemctl stop firewalld这条指令来关闭该功能"></a>如果要关闭防火墙设置，可能通过systemctl stop firewalld这条指令来关闭该功能</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld</span><br></pre></td></tr></table></figure><h2 id="nginx具体配置"><a href="#nginx具体配置" class="headerlink" title="nginx具体配置"></a>nginx具体配置</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen    80;</span><br><span class="line">    server_name localhost;</span><br><span class="line">    location / &#123;</span><br><span class="line">      root  html;</span><br><span class="line">      index index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br></pre></td></tr></table></figure><p>  在这里如果不加其他的情况基本都是root就直接在相对位置上弄，root就直接弄安装nginx的根目录下的文件夹就可以了（就是直接一个nginx目录下的文件，直接嵌套就可以了），<br>  然后location后面的/是相对于路由吧，会直接加载到root目录后面访问文件。就相当于location后面的 /。。。加到访问端口上，然后服务器自动加上root在location之前来寻址</p><h2 id="应该注意到问题"><a href="#应该注意到问题" class="headerlink" title="应该注意到问题"></a>应该注意到问题</h2><h3 id="文件访问限权问题"><a href="#文件访问限权问题" class="headerlink" title="文件访问限权问题"></a>文件访问限权问题</h3><p>我们在部署的时候会发生一些事情，比如按照正常部署的的节奏来，除非寻址出现问题，是不会有直接空白页的现象存在的，如果有的话，可能是访问的html这些在目录下的文件读取限权是没有的，这时候我们需要手动打开</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chomd 777 *</span><br><span class="line">//对应的文件</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;nginx使用教程&quot;&gt;&lt;a href=&quot;#nginx使用教程&quot; class=&quot;headerlink&quot; title=&quot;nginx使用教程&quot;&gt;&lt;/a&gt;nginx使用教程&lt;/h1&gt;&lt;p&gt;本nginx是在Ubuntu20.04系统下运行的&lt;br&gt;nginx version</summary>
      
    
    
    
    <category term="教程" scheme="http://example.com/categories/%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="nginx" scheme="http://example.com/tags/nginx/"/>
    
  </entry>
  
  <entry>
    <title>springboot-use</title>
    <link href="http://example.com/2021/07/18/springboot-use/"/>
    <id>http://example.com/2021/07/18/springboot-use/</id>
    <published>2021-07-18T08:45:55.328Z</published>
    <updated>2021-07-20T15:32:35.980Z</updated>
    
    <content type="html"><![CDATA[<h1 id="后端学习日志："><a href="#后端学习日志：" class="headerlink" title="后端学习日志："></a>后端学习日志：</h1><h2 id="SpringBootMVC的结构解读："><a href="#SpringBootMVC的结构解读：" class="headerlink" title="SpringBootMVC的结构解读："></a>SpringBootMVC的结构解读：</h2><p>对于SpringBoot来说一个高内聚低耦合的框架必须要遵守一个能够承受得住较大量开发的逻辑难度，有些开发者是单人开发，所面临的主要开发问题是如何记住自己写过的每一个功能，并且某些功能与功能之间也可能出现一些功能上的重合，可能需要调用很多相同的函数或者是根本就是相似的写法或者功能，如何去组织这些功能之间的耦合性与内聚性达到一种比较和谐的平衡关系，这就需要有一套管理代码调用的机制MVC，在一般的开发者面前这个机制也许是用来管理代码的，更有深层次的解读。</p><p>View层：用于接受用户提交请求的代码，也就是在我们所开发的项目中的所用到的Controller层，这一层负责将前端开发者用到的服务整合并将接口暴露出来用于接受前端开发者的请求与传入的参数并对其进行一定的提取和整合，接着将前端请求逻辑上进行对服务层的接口进行调用。</p><p>Service层：系统的业务逻辑主要在这里完成。用户的请求在View层得到处理后调用Service层的函数来实现具体的操作并将后端数据库的操作进行调用，从而实现整个逻辑层。</p><p>Dao层：Service层的逻辑实现过程中会对数据库进行操作，Dao层就是实现了一系列对数据库操作的函数和类。</p><p>这三层都会以接口或者抽象方式将自己的所提供的函数暴露出来，上层对下层的调用通过接口来实现，底层才是上层逻辑或者要求的服务的真正提供者。</p><p>在这三层之外，对于数据库的操作，也就是Dao这一层，我们将数据库返回出来的关系也可以抽象成一个实体类，于是Dao层中对数据库进行操作过程中传出的参数，会直接由SpringBoot中对注解以及封装的接口将其自动封装为自己之前定义好的实体类，也就是entity，如果我们使用传统的mybatis生成结构的话，会出现比较传统的xml注入的情况，于是也就有了对应的Dao层对于xml的映射关系，对于这层关系来说，每一个Dao操作的类，都会对应在Mapper.xml中找到对应自己接口名的id，在规定好传入参数和穿出参数后，就可以进行合理的映射，每当有服务层的服务去调用Dao层对数据库调用的接口时，Dao的接口在注解的封装下就会自动去映射其对应的Mapper.xml中所调用接口的xml标签，对应找到标签以后会在标签内所写的结构化的sql语言的注入到数据库中，从而实现对应的数据库的操作。</p><h2 id="SpringBoot注解解读："><a href="#SpringBoot注解解读：" class="headerlink" title="SpringBoot注解解读："></a>SpringBoot注解解读：</h2><p>对于一般的使用上面来说，如果不用mybatis的话我是这么使用的：</p><p>首先我们从entity层开始写起，这一层在一般情况下不需要注解，因为只是一个实体类。</p><p>写好对应的entity实体类时候我们开始对Dao数据库层进行操作，Dao中首先需要Mapper将这个接口与对应的XML对应上，然后按照我的习惯，会直接对对应的接口进行数据库操作的注入，直接在接口上方用@Insert或者@Delete等来注入比如：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PaperMaitainDao</span></span>&#123;</span><br><span class="line">  <span class="meta">@Insert(&quot;INSERT INTO paper_maitain (tea_id,paper_id,qulid_id) VALUES (#&#123;teaId&#125;, #&#123;paperId&#125;,#&#123;qualifId&#125;)&quot;)</span></span><br><span class="line"><span class="function">boolen <span class="title">insertPaperMaitain</span><span class="params">(PaperMaitain paperMaitian)</span></span>;</span><br><span class="line">  <span class="comment">//PaperMaitain是在entity中的实体类</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>做好这一层的逻辑构成了，我们开始更上一层的服务层在这里我们需要注册一个服务接口@Service</p><p>然后注入对应要使用的Dao的接口服务，一般使用到@Resource或者@Autowired</p><p>然后我们就可以写对应的服务接口了</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TeacherService</span></span>&#123;</span><br><span class="line">  <span class="meta">@Resource</span></span><br><span class="line">  <span class="keyword">private</span> PaperMaintainDao paperMaintainDao;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> Boolean <span class="title">createPaperMaintain</span><span class="params">(PaperMaintain paperMaintain)</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">           <span class="keyword">return</span> paperMaintainDao.insertPaperMaintain(paperMaintain);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们的服务就此写好后，接下来就是将一系列的服务操作与前端对接风部分了Controller层</p><p>首先先声明这个对应的Controller使用@RestController</p><p>然后对应我们要在路由上面进行对应起来，@RequestMapping(value = “/teacher”)这一个总的接口会在root/teacher上面开启</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;/teacher&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TeacherController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> TeacherService teacherService;</span><br><span class="line">  <span class="comment">//这里是直接调用服务层，引入资源</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">//做一个在/teacher下的路由映射，访问这个接口需要root/teacher/createPaperMaintain</span></span><br><span class="line">  <span class="meta">@RequestMapping(value = &quot;/createPaperMaintain&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">createPaperMaintains</span><span class="params">(<span class="meta">@RequestBody</span> Map&lt;String, Object&gt; request)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> teaId = (<span class="keyword">int</span>) request.get(<span class="string">&quot;tea_id&quot;</span>);</span><br><span class="line">        String paperId = (String) request.get(<span class="string">&quot;paper_id&quot;</span>);</span><br><span class="line">        Integer qualifId = (Integer) request.get(<span class="string">&quot;qualif_id&quot;</span>);</span><br><span class="line">        PaperMaintain paperMaintain  = <span class="keyword">new</span> PaperMaintain();</span><br><span class="line">        paperMaintain.setPaperId(paperId);</span><br><span class="line">        paperMaintain.setQualifId(qualifId);</span><br><span class="line">        paperMaintain.setTeaId(teaId);</span><br><span class="line">        <span class="keyword">return</span> Result.succ(teacherService.createPaperMaintain(paperMaintain));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="关于应对前端传入的数组问题"><a href="#关于应对前端传入的数组问题" class="headerlink" title="关于应对前端传入的数组问题"></a>关于应对前端传入的数组问题</h3><h4 id="前端传入的数组对于java来说其实是一个单独的ArrayList，所以可以单独用这个来接受，因此，就会有下面的操作"><a href="#前端传入的数组对于java来说其实是一个单独的ArrayList，所以可以单独用这个来接受，因此，就会有下面的操作" class="headerlink" title="前端传入的数组对于java来说其实是一个单独的ArrayList，所以可以单独用这个来接受，因此，就会有下面的操作"></a>前端传入的数组对于java来说其实是一个单独的ArrayList，所以可以单独用这个来接受，因此，就会有下面的操作</h4><p>1.如果前端直接传输的是一个数组，则在Controller的接口层面就直接（@RequestBody ArrayList&lt;数组中json在实体类对应的类型&gt; request）<br>2.直接在实体类中定义对应的接收的实体类，然后定义前端要专递数据的类型</p><h5 id="比如下面这个实体类："><a href="#比如下面这个实体类：" class="headerlink" title="比如下面这个实体类："></a>比如下面这个实体类：</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentCourseUpdaterCollection</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer courseId;</span><br><span class="line">    <span class="keyword">private</span> List&lt;StudentCourseUpdater&gt; studentCourseUpdaters;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getCourseId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> courseId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCourseId</span><span class="params">(Integer courseId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.courseId = courseId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;StudentCourseUpdater&gt; <span class="title">getStudentCourseUpdaters</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> studentCourseUpdaters;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStudentCourseUpdaters</span><span class="params">(List&lt;StudentCourseUpdater&gt; studentCourseUpdaters)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.studentCourseUpdaters = studentCourseUpdaters;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="然后后端的接收的接口是这样的："><a href="#然后后端的接收的接口是这样的：" class="headerlink" title="然后后端的接收的接口是这样的："></a>然后后端的接收的接口是这样的：</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/updateStuCourseByKey&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">updateStuCourseByKey</span><span class="params">(<span class="meta">@RequestBody</span> StudentCourseUpdaterCollection studentCourseUpdaterCollection)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        ArrayList&lt;Integer&gt; ids= <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//System.out.println(studentCourseUpdaterCollection.getCourseId());</span></span><br><span class="line">        <span class="keyword">for</span>( StudentCourseUpdater studentCourseUpdater: studentCourseUpdaterCollection.getStudentCourseUpdaters() )&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(teacherService.updateStuCourseByKey(studentCourseUpdater)==<span class="number">0</span>)&#123;</span><br><span class="line">                    ids.add(studentCourseUpdater.getStuId());</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception  e) &#123;</span><br><span class="line">                    ids.add(studentCourseUpdater.getStuId());</span><br><span class="line">                    <span class="comment">//System.out.println(studentCourseUpdater.getStuId());</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//System.out.println(studentCourseUpdater.getScore());</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(ids.size()==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> Result.succ(<span class="string">&quot;操作成功&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            String msg=<span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> id:ids)&#123;</span><br><span class="line">                msg+=id+<span class="string">&quot;,&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;操作失败！&quot;</span>+<span class="string">&quot;失败id：&quot;</span>+msg);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h5 id="前端在传递参数的时候也要按照对应的格式来"><a href="#前端在传递参数的时候也要按照对应的格式来" class="headerlink" title="前端在传递参数的时候也要按照对应的格式来"></a>前端在传递参数的时候也要按照对应的格式来</h5><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;courseId&quot;</span>:<span class="number">480120</span>,</span><br><span class="line">    <span class="attr">&quot;studentCourseUpdaters&quot;</span>:[</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;stuId&quot;</span>:<span class="number">201656788</span>,</span><br><span class="line">            <span class="attr">&quot;courseId&quot;</span>:<span class="number">80120</span>,</span><br><span class="line">            <span class="attr">&quot;score&quot;</span>:<span class="number">79</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以上是一个比较粗略的一个springboot从整体到局部的一个解析，也是这一周将之前学到的知识参与实践的操作。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;后端学习日志：&quot;&gt;&lt;a href=&quot;#后端学习日志：&quot; class=&quot;headerlink&quot; title=&quot;后端学习日志：&quot;&gt;&lt;/a&gt;后端学习日志：&lt;/h1&gt;&lt;h2 id=&quot;SpringBootMVC的结构解读：&quot;&gt;&lt;a href=&quot;#SpringBootMVC的</summary>
      
    
    
    
    
    <category term="springboot" scheme="http://example.com/tags/springboot/"/>
    
  </entry>
  
  <entry>
    <title>git-use</title>
    <link href="http://example.com/2021/07/16/git-use/"/>
    <id>http://example.com/2021/07/16/git-use/</id>
    <published>2021-07-16T12:02:32.209Z</published>
    <updated>2021-07-16T12:16:02.624Z</updated>
    
    <content type="html"><![CDATA[<h1 id="在Mac的终端上输入git检测是否安装git，如果没有，点击弹出的“安装”按钮。"><a href="#在Mac的终端上输入git检测是否安装git，如果没有，点击弹出的“安装”按钮。" class="headerlink" title="在Mac的终端上输入git检测是否安装git，如果没有，点击弹出的“安装”按钮。"></a>在Mac的终端上输入git检测是否安装git，如果没有，点击弹出的“安装”按钮。</h1><h1 id="安装完成之后，在终端输入-git-–version-查看版本信息"><a href="#安装完成之后，在终端输入-git-–version-查看版本信息" class="headerlink" title="安装完成之后，在终端输入 git –version 查看版本信息"></a>安装完成之后，在终端输入 git –version 查看版本信息</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git --version</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="创建一个全局用户名、全局邮箱作为配置信息"><a href="#创建一个全局用户名、全局邮箱作为配置信息" class="headerlink" title="创建一个全局用户名、全局邮箱作为配置信息"></a>创建一个全局用户名、全局邮箱作为配置信息</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name <span class="string">&quot;your_name&quot;</span>  </span><br><span class="line">git config --global user.email <span class="string">&quot;your_email@youremail.com&quot;</span></span><br></pre></td></tr></table></figure><h1 id="配置信息可以更改，以后想要更改使用上面指令就可以。同时可以使用git-config-–list指令查看Git的配置信息。"><a href="#配置信息可以更改，以后想要更改使用上面指令就可以。同时可以使用git-config-–list指令查看Git的配置信息。" class="headerlink" title="配置信息可以更改，以后想要更改使用上面指令就可以。同时可以使用git config –list指令查看Git的配置信息。"></a>配置信息可以更改，以后想要更改使用上面指令就可以。同时可以使用git config –list指令查看Git的配置信息。</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --list</span><br></pre></td></tr></table></figure><h1 id="Git默认对大小写不敏感，也就是说，将一个文件名某个字母做了大小写转换的修改Git是忽略这个改动的，导致在同步代码时候会出现错误，所以建议把Git设置成大小写敏感。"><a href="#Git默认对大小写不敏感，也就是说，将一个文件名某个字母做了大小写转换的修改Git是忽略这个改动的，导致在同步代码时候会出现错误，所以建议把Git设置成大小写敏感。" class="headerlink" title="Git默认对大小写不敏感，也就是说，将一个文件名某个字母做了大小写转换的修改Git是忽略这个改动的，导致在同步代码时候会出现错误，所以建议把Git设置成大小写敏感。"></a>Git默认对大小写不敏感，也就是说，将一个文件名某个字母做了大小写转换的修改Git是忽略这个改动的，导致在同步代码时候会出现错误，所以建议把Git设置成大小写敏感。</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config core.ignorecase <span class="literal">false</span></span><br></pre></td></tr></table></figure><h1 id="生成密匙"><a href="#生成密匙" class="headerlink" title="生成密匙"></a>生成密匙</h1><h2 id="Git关联远端仓库时候需要提供公钥，本地保存私钥，每次与远端仓库交互时候，远端仓库会用公钥来验证交互者身份。使用以下指令生成密钥，如果有提示，一路点击回车。"><a href="#Git关联远端仓库时候需要提供公钥，本地保存私钥，每次与远端仓库交互时候，远端仓库会用公钥来验证交互者身份。使用以下指令生成密钥，如果有提示，一路点击回车。" class="headerlink" title="Git关联远端仓库时候需要提供公钥，本地保存私钥，每次与远端仓库交互时候，远端仓库会用公钥来验证交互者身份。使用以下指令生成密钥，如果有提示，一路点击回车。"></a>Git关联远端仓库时候需要提供公钥，本地保存私钥，每次与远端仓库交互时候，远端仓库会用公钥来验证交互者身份。使用以下指令生成密钥，如果有提示，一路点击回车。</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">&quot;your_email@youremail.com&quot;</span></span><br></pre></td></tr></table></figure><h2 id="生成密钥后，在本地的-Users-当前电脑用户-ssh目录下会生成两个文件id-rsa、id-rsa-pub，id-rsa文件保存的是私钥，保存于本地，id-rsa-pub文件保存的是公钥，需要将里面内容上传到远端仓库。"><a href="#生成密钥后，在本地的-Users-当前电脑用户-ssh目录下会生成两个文件id-rsa、id-rsa-pub，id-rsa文件保存的是私钥，保存于本地，id-rsa-pub文件保存的是公钥，需要将里面内容上传到远端仓库。" class="headerlink" title="生成密钥后，在本地的/Users/当前电脑用户/.ssh目录下会生成两个文件id_rsa、id_rsa.pub，id_rsa文件保存的是私钥，保存于本地，id_rsa.pub文件保存的是公钥，需要将里面内容上传到远端仓库。"></a>生成密钥后，在本地的/Users/当前电脑用户/.ssh目录下会生成两个文件id_rsa、id_rsa.pub，id_rsa文件保存的是私钥，保存于本地，id_rsa.pub文件保存的是公钥，需要将里面内容上传到远端仓库。</h2><h1 id="获取密匙字符串"><a href="#获取密匙字符串" class="headerlink" title="获取密匙字符串"></a>获取密匙字符串</h1><p>输入cd指令，进入当前用户目录<br>输入ls -a指令，查看当前用户目录下所有文件，包括隐藏文件<br>输入cd .ssh指令，进入.ssh目录<br>输入ls指令，查看.ssh目录下的文件<br>输入cat id_rsa.pub指令，查看id_rsa.pub文件中内容</p><h1 id="打开你的github账号，在Settings中的左侧边导航中找到SSH-and-GPG-keys，点击左面面板右上方的New-SSH-key添加密匙"><a href="#打开你的github账号，在Settings中的左侧边导航中找到SSH-and-GPG-keys，点击左面面板右上方的New-SSH-key添加密匙" class="headerlink" title="打开你的github账号，在Settings中的左侧边导航中找到SSH and GPG keys，点击左面面板右上方的New SSH key添加密匙"></a>打开你的github账号，在Settings中的左侧边导航中找到SSH and GPG keys，点击左面面板右上方的New SSH key添加密匙</h1><h1 id="Git常用命令"><a href="#Git常用命令" class="headerlink" title="Git常用命令"></a>Git常用命令</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;在Mac的终端上输入git检测是否安装git，如果没有，点击弹出的“安装”按钮。&quot;&gt;&lt;a href=&quot;#在Mac的终端上输入git检测是否安装git，如果没有，点击弹出的“安装”按钮。&quot; class=&quot;headerlink&quot; title=&quot;在Mac的终端上输入gi</summary>
      
    
    
    
    <category term="学习记录" scheme="http://example.com/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
    
    
    <category term="git" scheme="http://example.com/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>nlp</title>
    <link href="http://example.com/2021/05/15/nlp/"/>
    <id>http://example.com/2021/05/15/nlp/</id>
    <published>2021-05-15T12:04:11.713Z</published>
    <updated>2021-05-22T14:05:59.594Z</updated>
    
    <content type="html"><![CDATA[<h1 id="pytorch"><a href="#pytorch" class="headerlink" title="pytorch"></a>pytorch</h1><p>有关pytorch的学习网站：<a href="https://pytorch-cn.readthedocs.io/zh/latest/">https://pytorch-cn.readthedocs.io/zh/latest/</a><br>另外一些有关pytorch的知识点如下</p><h2 id="PyTorch中的Tensor张量"><a href="#PyTorch中的Tensor张量" class="headerlink" title="PyTorch中的Tensor张量"></a>PyTorch中的Tensor张量</h2><h3 id="1-Tensor张量"><a href="#1-Tensor张量" class="headerlink" title="1.Tensor张量"></a>1.Tensor张量</h3><p>我们可以将这个理解为矩阵</p><h3 id="2-Tensor数据类型"><a href="#2-Tensor数据类型" class="headerlink" title="2.Tensor数据类型"></a>2.Tensor数据类型</h3><p>（1）torch.FloatTensor()参数可以直接是一个元组然后转化为Tensor；或者是两个参数，n，m直接代表矩阵的维度已经形状。<br>（2）torch.IntTensor，用于生成数据类型为整形的tensor。</p><h3 id="3-Tensor常用函数"><a href="#3-Tensor常用函数" class="headerlink" title="3.Tensor常用函数"></a>3.Tensor常用函数</h3><p>（1）torch.rand    # 用于生成数据类型为浮点型且维度指定的随机Tensor，和在Numpy中使用numpy.rand生成随机数的方法类似，随机生成的浮点数据在0~1区间均匀分布。</p><p>（2）torch.randn    # 用于生成数据类型为浮点型且维度指定的随机Tensor，和在Numpy中使用numpy.randn生成随机数的方法类似，随机生成的浮点数的取值满足均值为0，方差为1的正太分布。</p><p>（3）torch.range    # 用于生成数据类型为浮点型且自定义其实范围和结束范围的Tensor，所以传递给torch.range的参数有三个，分别是范围的起始值，范围的结束值和步长，其中，步长用于指定从起始值到结束值的每步的数据间隔。</p><p>（4）torch.zeros    # 用于生成数据类型为浮点型且维度指定的Tensor，不过这个浮点型的Tensor中的元素值全部为0。</p><p>（5）torch.abs    # 将参数传递到torch.abs后返回输入参数的绝对值作为输出，输出参数必须是一个Tensor数据类型的变量。</p><p>（6）torch.add    # 将参数传递到torch.add后返回输入参数的求和结果作为输出，输入参数既可以全部是Tensor数据类型的变量，也可以是一个Tensor数据类型的变量，另一个是标量。</p><p>（7）torch.clamp    # 对输入参数按照自定义的范围进行裁剪，最后将参数裁剪的结果作为输出。所以输入参数一共有三个，分别是需要进行裁剪的Tensor数据类型的变量、裁剪的上边界和裁剪的下边界，具体的裁剪过程是：使用变量中的每个元素分别和裁剪的上边界及裁剪的下边界的值进行比较，如果元素的值小于裁剪的下边界的值，该元素就被重写成裁剪的下边界的值；同理，如果元素的值大于裁剪的上边界的值，该元素就被重写成裁剪的上边界的值。</p><p>（8）torch.div    # 将参数传递到torch.div后返回输入参数的求商结果作为输出，同样，参与运算的参数可以全部是Tensor数据类型的变量，也可以是Tensor数据类型的变量和标量的组合。(两个参数，第一个是被除数，第二个是除数)</p><p>（9）torch.pow    # 将参数传递到torch.pow后返回输入参数的求幂结果作为输出，参与运算的参数可以全部是Tensor数据类型的变量，也可以是Tensor数据类型的变量和标量的组合。</p><p>（10）torch.mul    # 将参数传递到 torch.mul后返回输入参数求积的结果作为输出，参与运算的参数可以全部是Tensor数据类型的变量，也可以是Tensor数据类型的变量和标量的组合。</p><p>（11）torch.mm    # 将参数传递到 torch.mm后返回输入参数的求积结果作为输出，不过这个求积的方式和之前的torch.mul运算方式不太样，torch.mm运用矩阵之间的乘法规则进行计算，所以被传入的参数会被当作矩阵进行处理，参数的维度自然也要满足矩阵乘法的前提条件，即前一个矩阵的行数必须和后一个矩阵的列数相等，否则不能进行计算。</p><p>（12）torch.mv    # 将参数传递到torch.mv后返回输入参数的求积结果作为输出，torch.mv运用矩阵与向量之间的乘法规则进行计算，被传入的参数中的第1个参数代表矩阵，第2个参数代表向量，顺序不能颠倒。<br>（以上基本都是二元运算，前面的参数是被运算的数，后面的是对前面多运算的参数,或者这个torch的实例直接去运行)</p><p>（13）torch.view    # 改变一个 tensor 的大小或者形状。</p><h2 id="神经网络堆叠"><a href="#神经网络堆叠" class="headerlink" title="神经网络堆叠"></a>神经网络堆叠</h2><h3 id="简易神经网络的堆叠"><a href="#简易神经网络的堆叠" class="headerlink" title="简易神经网络的堆叠"></a>简易神经网络的堆叠</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line">import torch</span><br><span class="line">batch_n = 100  <span class="comment">#一个批次中输入数据的数量,值是100表示在一个批次中输入100个数据</span></span><br><span class="line">input_data = 1000  <span class="comment">#每个数据包含的数据特征</span></span><br><span class="line">hidden_layer = 100 <span class="comment">#经过隐藏层后保留的数据特征的个数</span></span><br><span class="line">output_data = 10  <span class="comment">#输出数据表示分类结果值的数量</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#初始化权重</span></span><br><span class="line">x = torch.randn(batch_n, input_data) <span class="comment">#输入层维度为（100,1000）</span></span><br><span class="line">y = torch.randn(batch_n, output_data) <span class="comment">#输出层维度为（100,10）</span></span><br><span class="line">w1 = torch.randn(input_data, hidden_layer) <span class="comment">#输入层到隐藏层的权重参数维度为（1000,100）</span></span><br><span class="line">w2 = torch.randn(hidden_layer, output_data) <span class="comment">#隐藏层到输出层的权重参数维度为（100,10）</span></span><br><span class="line">epoch_n = 20  <span class="comment">#训练的次数</span></span><br><span class="line">learning_rate = 1e-6 <span class="comment">#学习效率</span></span><br><span class="line"><span class="comment">#梯度下降优化神经网络参数</span></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> range(epoch_n):</span><br><span class="line">    h1 = x.mm(w1)  <span class="comment"># 100*1000</span></span><br><span class="line">    h1 = h1.clamp(min=0) <span class="comment">#使用clamp方法进行裁剪，将小于零的值全部重新赋值于0</span></span><br><span class="line">    y_pred = h1.mm(w2)  <span class="comment"># 100*10</span></span><br><span class="line">    <span class="comment"># print(y_pred)</span></span><br><span class="line">    loss = (y_pred - y).pow(2).sum()  <span class="comment">#均方误差计算损失</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Epoch:&#123;&#125; , Loss:&#123;:.4f&#125;&quot;</span>.format(epoch, loss))</span><br><span class="line">    gray_y_pred = 2 * (y_pred - y)</span><br><span class="line">    gray_w2 = h1.t().mm(gray_y_pred)  <span class="comment">#.t()是将Tensor进行转置</span></span><br><span class="line">    grad_h = gray_y_pred.clone()</span><br><span class="line">    grad_h = grad_h.mm(w2.t())</span><br><span class="line">    grad_h.clamp_(min=0)</span><br><span class="line">    grad_w1 = x.t().mm(grad_h)  <span class="comment">#权重参数对应的梯度</span></span><br><span class="line">    w1 -= learning_rate * grad_w1 <span class="comment">#根据学习率对w1和w2的权重参数进行更新</span></span><br><span class="line">    w2 -= learning_rate * gray_w2</span><br></pre></td></tr></table></figure><h3 id="2-Pytorch自动梯度"><a href="#2-Pytorch自动梯度" class="headerlink" title="2.Pytorch自动梯度"></a>2.Pytorch自动梯度</h3><p>autograd package 是PyTorch中所有神经网络的核心，它提供了Tensors上所有运算的自动求导功能，通过torch.autograd包，可以使模型参数自动计算在优化过程中需要用到的梯度值，在很大程度上帮助降低了实现后向传播代码的复杂度。</p><p>torch.autograd 包的主要功能是完成神经网络后向传播中的链式求导。</p><p>autograd.Variable 是这个package的中心类。它打包了一个Tensor，并且支持几乎所有运算。一旦你完成了你的计算，可以调用.backward()，所有梯度就可以自动计算。</p><h3 id="3-使用自动梯度和自定义函数搭建简易神经网络模型"><a href="#3-使用自动梯度和自定义函数搭建简易神经网络模型" class="headerlink" title="3.使用自动梯度和自定义函数搭建简易神经网络模型"></a>3.使用自动梯度和自定义函数搭建简易神经网络模型</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">import torch</span><br><span class="line">from torch.autograd import Variable</span><br><span class="line"> </span><br><span class="line"><span class="comment">#构建神经网络模型</span></span><br><span class="line">class Model(torch.nn.Module):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(Model,self).__init__()</span><br><span class="line">        <span class="comment">#super().__init__()</span></span><br><span class="line">    def forward(self,input,w1,w2):</span><br><span class="line">        x=torch.mm(input,w1)</span><br><span class="line">        x=torch.clamp(x,min=0)</span><br><span class="line">        x=torch.mm(x,w2)</span><br><span class="line">        <span class="built_in">return</span> x</span><br><span class="line">    def backward(self):</span><br><span class="line">        pass</span><br><span class="line"> </span><br><span class="line">batch_n = 100 <span class="comment"># 批量输入的数据量</span></span><br><span class="line">hidden_layer = 100 <span class="comment"># 通过隐藏层后输出的特征数</span></span><br><span class="line">input_data = 1000 <span class="comment"># 输入数据的特征个数</span></span><br><span class="line">output_data = 10 <span class="comment"># 最后输出的分类结果数</span></span><br><span class="line"><span class="comment">#初始化权重</span></span><br><span class="line">x = Variable(torch.randn(batch_n, input_data), requires_grad=False)</span><br><span class="line">y = Variable(torch.randn(batch_n, output_data), requires_grad=False)</span><br><span class="line">w1 = Variable(torch.randn(input_data, hidden_layer), requires_grad=True)</span><br><span class="line">w2 = Variable(torch.randn(hidden_layer, output_data), requires_grad=True)</span><br><span class="line">epoch_n = 20  <span class="comment">#训练的次数</span></span><br><span class="line">learning_rate = 1e-6 <span class="comment">#学习效率</span></span><br><span class="line">model=Model() <span class="comment">#对模型类进行调用</span></span><br><span class="line"><span class="comment">#模型训练和参数优化</span></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> range(epoch_n):</span><br><span class="line">    y_pred = model(x,w1,w2) <span class="comment">#完成对模型预测值的输出</span></span><br><span class="line">    loss = (y_pred - y).pow(2).sum()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Epoch:&#123;&#125; , Loss:&#123;:.4f&#125;&quot;</span>.format(epoch, loss.data))</span><br><span class="line">    loss.backward()  <span class="comment">#自动计算所有梯度</span></span><br><span class="line">    w1.data -= learning_rate * w1.grad.data</span><br><span class="line">    w2.data -= learning_rate * w2.grad.data</span><br><span class="line">    w1.grad.data.zero_()</span><br><span class="line">    w2.grad.data.zero_()</span><br></pre></td></tr></table></figure><h1 id="词向量学习"><a href="#词向量学习" class="headerlink" title="词向量学习"></a>词向量学习</h1><h2 id="One-hot编码"><a href="#One-hot编码" class="headerlink" title="One hot编码"></a>One hot编码</h2><h3 id="什么是One-hot编码"><a href="#什么是One-hot编码" class="headerlink" title="什么是One hot编码"></a>什么是One hot编码</h3><p>one-hot编码，又称独热编码、一位有效编码。其方法是使用N位状态寄 存器来对N个状态进行编码，每个状态都有它独立的寄存器位，并且在 任意时候，其中只有一位有效。举个例子，假设我们有四个样本(行)， 每个样本有三个特征(列)，如下图:</p><table><thead><tr><th></th><th>Feature_1</th><th>Feature_2</th><th>Feature_3</th></tr></thead><tbody><tr><td>Sample1</td><td>1</td><td>4</td><td>3</td></tr><tr><td>Sample2</td><td>2</td><td>3</td><td>2</td></tr><tr><td>Sample3</td><td>1</td><td>2</td><td>2</td></tr><tr><td>Sample4</td><td>2</td><td>1</td><td>1</td></tr></tbody></table><p>上图中我们已经对每个特征进行了普通的数字编码:我们的feature_1有两种可能的取值，比如是男/ 女，这里男用1表示，女用2表示。</p><p>那么one-hot编码是怎么搞的呢?我们再拿feature_2来说明:这里 feature_2 有4种取值(状态)，我们就用4个状态位来表示这个特 征，one-hot编码就是保证每个样本中的单个特征只有1位处于状态 1，其他的都是0。</p><p>​    1-&gt;0001</p><p>​    2-&gt;0010</p><p>​    3-&gt;0100</p><p>​    4-&gt;1000</p><p>对于2种状态、3种状态、甚至更多状态都可以这样表示，所以我们可以 得到这些样本特征的新表示，入下图:</p><table><thead><tr><th></th><th>Feature_1</th><th>Feature_2</th><th>Feature_3</th></tr></thead><tbody><tr><td>Sample1</td><td>01</td><td>1000</td><td>100</td></tr><tr><td>Sample2</td><td>10</td><td>0100</td><td>010</td></tr><tr><td>Sample3</td><td>01</td><td>0010</td><td>010</td></tr><tr><td>Sample4</td><td>10</td><td>0001</td><td>001</td></tr></tbody></table><p>one-hot编码将每个状态位都看成一个特征。对于前两个样本我们可以得到它的特征向量分别为</p><p>​    Sample_1-&gt;[0,1,1,0,0,0,1,0,0]</p><p>​    Sample_2-&gt;[1,0,0,1,0,0,0,1,0]</p><h3 id="优缺点分析"><a href="#优缺点分析" class="headerlink" title="优缺点分析"></a>优缺点分析</h3><h4 id="优点："><a href="#优点：" class="headerlink" title="优点："></a>优点：</h4><p>1.解决了分类器不好处理离散数据的问题<br>2.在一定程度上也起到了扩充特征的作用</p><h4 id="缺点："><a href="#缺点：" class="headerlink" title="缺点："></a>缺点：</h4><p>1.在文本特征上缺点就非常突出了<br>2.它是一个提词袋不考虑词与词之间的顺序<br>3.他假 设词与词相互独立（在大多数情况下，词与词是相互影响的）<br>4.他得到的特征是稀疏的</p><h2 id="word2vec相关概念"><a href="#word2vec相关概念" class="headerlink" title="word2vec相关概念"></a>word2vec相关概念</h2><p>2013年Google团队发表了word2vec工具。word2vec工具主要包含两个模型：跳字模型（skip-gram）和连续词袋模型（continuous bag of words，简称CBOW），以及两种高效训练的方法：负采样（negative samoling）和层序softmax（hierarchical softmax），值得一提的是，word2vec词向量可以较好的表达不同词之间类似和类比关系。</p><h2 id="模型："><a href="#模型：" class="headerlink" title="模型："></a>模型：</h2><h3 id="跳字模型："><a href="#跳字模型：" class="headerlink" title="跳字模型："></a>跳字模型：</h3><p>在跳字模型中，我们用一个词来预测它在文本序列周围的词。例如，给定文本“the”，“main”，“hit”，“his”和“son”，跳字模型所关心的是，给定“hit”，生成它的临近词“the”，“main”，“hit”和“son”的概率</p><p><img src="/images/skip-gram-1.PNG" alt="skip-gram-1"></p><p><img src="/images/skip-gram-2.PNG" alt="skip-gram-2"></p><p>上述公式中，T表示窗口中心词的位置，m表示的窗口的大小。这样就可以计算出每个中心词推断背景词的概率，而我们在输入的时候给出了背景词的向量，此时只需要最大化背景词的输出概率即可。 基于这样的想法，我们会想到极大化似然估计的方式。但是一个函数的最大值往往不容易计算，因此，我们可以通过对函数进行变换，从而改变函数的增减性，以便优化。</p><p>注解：看到这里，就引出了word2vec的核心方法，其实就是认为每个词相互独立，用连乘来估计最大似然函数，求解目标函数就是最大化似然函数。上面公式涉及到一个中心词向量v，以及背景词向量u，因此呢很有趣的是，可以用一个input-hidden-output的三层神经网络来建模上面的skip-model。</p><p>Skip-gram可以表示为由输入层（Input）、映射层（Projection）和输出层（Output）组成的神经网络（示意图如下）：<br><img src="/images/skip-gram-3.jpg" alt="skip-gram-3"></p><p><img src="/images/skimgram.png" alt="skipgram"></p><p>1.输入的表示：输入层中每个词由独热编码方式表示，即所有词均表示成一个N维向量，其中N为词汇表中单词的总数。在向量中，每个词都将与之对应的维度置为1,其余维度的值均为0。<br>2.网络中传播的前向过程：输出层向量的值可以通过隐含层向量（K维），以及连接隐藏层和输出层之间的KxN维权重矩阵计算得到。输出层也是一个N维向量，每维与词汇表中的一个单词相对应。最后对输出层向量应用Softmax激活函数，可以计算每一个单词的生成概率。<br>训练：<br><img src="/images/skip-gram-4.PNG" alt="skip-gram-4"></p><p>注解：上面的公式每一步都推荐推到一下，都很基础。上面只求了对中心词向量v的梯度，同理对背景词向量的梯度，也很容易计算出来。然后就采用传统的梯度下降（一般采用sgd）来训练词向量（其实我们最后关心的是中心词向量来作为词的表征。）</p><p>这里有一个key point说下，也许大家也想到了：词向量到底在哪里呢？回看下前面图1，有两层神经网络，第一层是input层到hidden层，这个中间的weight矩阵就是词向量！！！</p><p>假设input的词汇表N长度是10000，hidden层的长度K=300，左乘以一个10000长度one-hot编码，实际上就是在做一个查表！因此，这个weight矩阵的行就是10000个词的词向量。很有创意是不是？再来看神经网络的第二层，hidden到out层，中间hidden层有没有激活函数呢？从前面建模看到，u和v是直接相乘的，没有激活层，所以hidden是一个线性层。out层就是建模了v和u相乘，结果过一个softmax，那么loss函数是最大似然怎么办呢？其实就是接多个只有一个true label（背景词）的cross entropy loss，把这些loss求和。因为交叉熵就是最大似然估计，如果这点不清楚的可以去网上搜一下，很容易知道。</p><p>所以呢，我们即可用前面常规的最大似然建模来理解如何对u和v的进行优化求解；也完全可以把skip-model套到上面图1这样的一个简单神经网络中，然后就让工具自己来完成weight的训练，就得到了我们想要的中心词向量。</p><p><img src="/images/skip-gram-5.jpg" alt="skip-gram-5"></p><p>下图是对这个过程的简单可视化过程示意图。左边矩阵为词汇表中第四个单词的one-hot表示，右边矩阵表示包含3个神经元的隐藏层的权重矩阵，做矩阵乘法的结果就是从权重矩阵中选取了第四行的权重。因此，这个隐藏层的权重矩阵就是我们最终想要获得的词向量字典[2]</p><p><img src="/images/skip-gram-6.jpg" alt="skip-gram-6"></p><p>获取训练样本：按照上下文窗口的大小从训练文本中提取出词汇对，下面以句子The quick brown fox jumps over the lazy dog为例提取用于训练的词汇对，然后将词汇对的两个单词使用one-hot编码就得到了训练用的train_data和target_data。 下面的图中给出了一些我们的训练样本的例子。我们选定句子“The quick brown fox jumps over lazy dog”，设定我们的窗口大小为2（window_size=2），也就是说我们仅选输入词前后各两个词和输入词进行组合。下图中，蓝色代表input word，方框内代表位于窗口内的单词。Training Samples（输入， 输出）示意图如下：</p><p><img src="/images/skip-gram-7.jpg" alt="skip-gram-7"></p><p>如果使用随机梯度下降，那么在每一次迭代里我们随机采样一个较短的子序列来计算有关该子序列的损失，然后计算梯度来更新模型参数。</p><h3 id="连续词袋模型（CBOW）"><a href="#连续词袋模型（CBOW）" class="headerlink" title="连续词袋模型（CBOW）"></a>连续词袋模型（CBOW）</h3><p>CBOW就倒过来，用多个背景词来预测一个中心词，CBOW对小型数据库比较合适，而Skip-Gram在大型语料中表现更好[2]。但是方法和上面是很像的，因此这里我就放下图。推导的方法是一样的。</p><p><img src="/images/CBOW-1.PNG" alt="CBOW-1"></p><p><img src="/images/CBOW-2.PNG" alt="CBOW-2"><br>我们发现，不论是跳字模型（skip-gram） 还是连续词袋模型（CBOW），我们实际上都是取得input-hidden这个词向量（weight矩阵），而不是后面带着loss那一部分，这样我们也很容易可以对loss（训练方法）进行修改，这个也是下一篇要说的内容：</p><p>问：每次梯度的计算复杂度是多少？当词典很大时，会有什么问题？</p><p>word2vec作者很创造性地提出了2种近似训练方法（分层softmax（hierarchical softmax）和负采样（negative sampling）），得益于此，可以训练大规模语料库。</p><h2 id="wordvrc优化方式"><a href="#wordvrc优化方式" class="headerlink" title="wordvrc优化方式"></a>wordvrc优化方式</h2><h3 id="近似训练"><a href="#近似训练" class="headerlink" title="近似训练"></a>近似训练</h3><h4 id="负采样"><a href="#负采样" class="headerlink" title="负采样"></a>负采样</h4><p><img src="/images/negative-sampling-1.png" alt="negative-sampling-1"></p><p><img src="/images/negative-sampling-2.png" alt="negative-sampling-2"></p><p><img src="/images/negative-sampling-3.png" alt="negative-sampling-3"></p><h4 id="层序softmax"><a href="#层序softmax" class="headerlink" title="层序softmax"></a>层序softmax</h4><p>一、h-softmax</p><p>在面对label众多的分类问题时，fastText设计了一种hierarchical softmax函数。使其具有以下优势：</p><p>（1）适合大型数据+高效的训练速度：能够训练模型“在使用标准多核CPU的情况下10分钟内处理超过10亿个词汇”，特别是与深度模型对比，fastText能将训练时间由数天缩短到几秒钟。<br>（2）支持多语言表达：利用其语言形态结构，fastText能够被设计用来支持包括英语、德语、西班牙语、法语以及捷克语等多种语言。<br>可以认为，FastText= （word2vec中）CBOW + h-softmax；其结构为：输入 - 隐层 - h-softmax</p><p>基本原理</p><p>根据标签（label）和频率建立霍夫曼树；（label出现的频率越高，Huffman树的路径越短）<br>Huffman树中每一叶子结点代表一个label； </p><p>二、理论分析</p><p>层次之间的映射</p><p>将输入层中的词和词组构成特征向量，再将特征向量通过线性变换映射到隐藏层，隐藏层通过求解最大似然函数，然后根据每个类别的权重和模型参数构建Huffman树，将Huffman树作为输出。 </p><p>模型的训练</p><p>Huffman树中每一叶子结点代表一个label，在每一个非叶子节点处都需要作一次二分类，走左边的概率和走右边的概率，这里用逻辑回归的公式表示 </p><p>模型的训练</p><p>Huffman树中每一叶子结点代表一个label，在每一个非叶子节点处都需要作一次二分类，走左边的概率和走右边的概率，这里用逻辑回归的公式表示 </p><p>模型的训练</p><p>Huffman树中每一叶子结点代表一个label，在每一个非叶子节点处都需要作一次二分类，走左边的概率和走右边的概率，这里用逻辑回归的公式表示</p><p><img src="/images/h-softmax.jpg" alt="h-softmax"> </p><p><img src="/images/h-softmax-1.png" alt="h-softmax-1"></p><p>how fast</p><p><img src="/images/h-softmax-2.png" alt="h-softmax-2"></p><h2 id="word2vec实现方式"><a href="#word2vec实现方式" class="headerlink" title="word2vec实现方式"></a>word2vec实现方式</h2><h2 id="word2vec实战"><a href="#word2vec实战" class="headerlink" title="word2vec实战"></a>word2vec实战</h2><h2 id="Glove"><a href="#Glove" class="headerlink" title="Glove"></a>Glove</h2><h3 id="预备知识"><a href="#预备知识" class="headerlink" title="预备知识"></a>预备知识</h3><p>共现概率：<br>什么是共现？<br>  单词 i i i出现在单词 j j j的环境中(论文给的环境是以 j j j为中心的左右10个单词区间)叫共现。</p><p>什么是共现矩阵？<br>  单词对共现次数的统计表。我们可以通过大量的语料文本来构建一个共现统计矩阵。<br>  例如，有语料如下：<br>  I like deep learning<br>  I like NLP<br>  I enjoy flying<br>  我以窗半径为1来指定上下文环境，则共现矩阵就应该是</p><table><thead><tr><th>count</th><th>I</th><th>like</th><th>enjoy</th><th>deep</th><th>learning</th><th>NLP</th><th>flying</th></tr></thead><tbody><tr><td>I</td><td>0</td><td>2</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>like</td><td>2</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td></tr><tr><td>enjoy</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td></tr><tr><td>deep</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td></tr><tr><td>learning</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td></tr><tr><td>NLP</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>flying</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td></tr></tbody></table><p>因为我们的窗口半径为1，所以对于上面我们的每一句语句来说，进行分析然后统计来看，最后出来的表上诉</p><p><img src="/images/glove-1.png" alt="glove-1"></p><p><img src="/images/glove-2.png" alt="glove-2"></p><p><img src="/images/glove-3.png" alt="glove-3"></p><p><img src="/images/glove-4.png" alt="glove-4"></p><p><img src="/images/glove-5.png" alt="glove-5"></p><p><img src="/images/glove-6.png" alt="glove-6"></p><h2 id="fasttext"><a href="#fasttext" class="headerlink" title="fasttext"></a>fasttext</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;pytorch&quot;&gt;&lt;a href=&quot;#pytorch&quot; class=&quot;headerlink&quot; title=&quot;pytorch&quot;&gt;&lt;/a&gt;pytorch&lt;/h1&gt;&lt;p&gt;有关pytorch的学习网站：&lt;a href=&quot;https://pytorch-cn.readthe</summary>
      
    
    
    
    <category term="教程" scheme="http://example.com/categories/%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="ai" scheme="http://example.com/tags/ai/"/>
    
  </entry>
  
  <entry>
    <title>tomcat</title>
    <link href="http://example.com/2021/05/15/tomcat/"/>
    <id>http://example.com/2021/05/15/tomcat/</id>
    <published>2021-05-15T07:59:57.849Z</published>
    <updated>2021-05-15T08:03:02.156Z</updated>
    
    
    
    
    <category term="教程" scheme="http://example.com/categories/%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="tomcat" scheme="http://example.com/tags/tomcat/"/>
    
  </entry>
  
  <entry>
    <title>nginx-use</title>
    <link href="http://example.com/2021/05/11/nginx-use/"/>
    <id>http://example.com/2021/05/11/nginx-use/</id>
    <published>2021-05-11T12:56:45.502Z</published>
    <updated>2021-07-21T16:30:53.573Z</updated>
    
    <content type="html"><![CDATA[<h1 id="nginx使用教程"><a href="#nginx使用教程" class="headerlink" title="nginx使用教程"></a>nginx使用教程</h1><p>本nginx是在Ubuntu20.04系统下运行的<br>nginx version: nginx/1.18.0 (Ubuntu)</p><h2 id="安装："><a href="#安装：" class="headerlink" title="安装："></a>安装：</h2><p>1.安装nginx的方法直接apt install nginx就可以<br>我们下面来看详细配置情况<br>当我们安装完nginx以后，可以在/etc/nginx中找到其配置情况<br>nginx.conf是它的配置文件,其中引入了confd.d/下的所有.conf文件<br>然后它的站点配置信息由sites-enabled/default这个文件配置,拿到这个站点文件之后就可以在里面生命server{}的站点配置<br>2.还有另外一种安装方式，先将它的安装打包文件传到服务器中，然后解压后进入文件./configure &amp;&amp;make&amp;&amp; make install<br>下面有几条相关的命令<br>启动：nginx 或者 nginx -c /配置文件的路径</p><p>  停止: nginx -s stop</p><p>  重启: nginx -s reload</p><p>  检查配置文件: nginx -t</p><p>  查看nginx启动情况: ps -ef | grep nginx</p><p>  如果出现报错<br>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx: [error] invalid PID number &quot;&quot; in &quot;/run/nginx.pid&quot;</span><br></pre></td></tr></table></figure></p><p>  需要先执行</p><p>  nginx -c /etc/nginx/nginx.conf</p><p>  nginx.conf文件的路径可以从nginx -t的返回中找到。</p><p>  nginx -s reload</p><p>  如果以上没用，则直接kill调nginx里面的进程</p><h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><p>  注:nginx的配置文件在安装后的nginx目录下的conf文件夹中</p><h3 id="一-刚安装好的配置文件具体如下"><a href="#一-刚安装好的配置文件具体如下" class="headerlink" title="(一):刚安装好的配置文件具体如下:"></a>(一):刚安装好的配置文件具体如下:</h3> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">#user  nobody;</span></span><br><span class="line">worker_processes  1;</span><br><span class="line"></span><br><span class="line"><span class="comment">#error_log  logs/error.log;</span></span><br><span class="line"><span class="comment">#error_log  logs/error.log  notice;</span></span><br><span class="line"><span class="comment">#error_log  logs/error.log  info;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#pid        logs/nginx.pid;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span></span><br><span class="line">    <span class="comment">#                  &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span></span><br><span class="line">    <span class="comment">#                  &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#access_log  logs/access.log  main;</span></span><br><span class="line"></span><br><span class="line">    sendfile        on;</span><br><span class="line">    <span class="comment">#tcp_nopush     on;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#keepalive_timeout  0;</span></span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#gzip  on;</span></span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  localhost;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#charset koi8-r;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#access_log  logs/host.access.log  main;</span></span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#error_page  404              /404.html;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># redirect server error pages to the static page /50x.html</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        error_page   500 502 503 504  /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root   html;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment">#location ~ \.php$ &#123;</span></span><br><span class="line">        <span class="comment">#    proxy_pass   http://127.0.0.1;</span></span><br><span class="line">        <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment">#location ~ \.php$ &#123;</span></span><br><span class="line">        <span class="comment">#    root           html;</span></span><br><span class="line">        <span class="comment">#    fastcgi_pass   127.0.0.1:9000;</span></span><br><span class="line">        <span class="comment">#    fastcgi_index  index.php;</span></span><br><span class="line">        <span class="comment">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span></span><br><span class="line">        <span class="comment">#    include        fastcgi_params;</span></span><br><span class="line">        <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># deny access to .htaccess files, if Apache&#x27;s document root</span></span><br><span class="line">        <span class="comment"># concurs with nginx&#x27;s one</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment">#location ~ /\.ht &#123;</span></span><br><span class="line">        <span class="comment">#    deny  all;</span></span><br><span class="line">        <span class="comment">#&#125;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># another virtual host using mix of IP-, name-, and port-based configuration</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#server &#123;</span></span><br><span class="line">    <span class="comment">#    listen       8000;</span></span><br><span class="line">    <span class="comment">#    listen       somename:8080;</span></span><br><span class="line">    <span class="comment">#    server_name  somename  alias  another.alias;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#    location / &#123;</span></span><br><span class="line">    <span class="comment">#        root   html;</span></span><br><span class="line">    <span class="comment">#        index  index.html index.htm;</span></span><br><span class="line">    <span class="comment">#    &#125;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># HTTPS server</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#server &#123;</span></span><br><span class="line">    <span class="comment">#    listen       443 ssl;</span></span><br><span class="line">    <span class="comment">#    server_name  localhost;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#    ssl_certificate      cert.pem;</span></span><br><span class="line">    <span class="comment">#    ssl_certificate_key  cert.key;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#    ssl_session_cache    shared:SSL:1m;</span></span><br><span class="line">    <span class="comment">#    ssl_session_timeout  5m;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#    ssl_ciphers  HIGH:!aNULL:!MD5;</span></span><br><span class="line">    <span class="comment">#    ssl_prefer_server_ciphers  on;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#    location / &#123;</span></span><br><span class="line">    <span class="comment">#        root   html;</span></span><br><span class="line">    <span class="comment">#        index  index.html index.htm;</span></span><br><span class="line">    <span class="comment">#    &#125;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上述是由安装包（第二种方法安装后的配置文件）<br>用第一种安装后的配置文件更加解耦化，有多个文件include而成，上诉有解释。配置相关差不多。</p><h3 id="二-配置详解"><a href="#二-配置详解" class="headerlink" title="(二)配置详解"></a>(二)配置详解</h3><p>1、根据上面的nginx配置文件,可以将nginx的配置分为以下的组成结构</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">... <span class="comment">#全局快</span></span><br><span class="line">events &#123;  <span class="comment">#events快</span></span><br><span class="line">&#125;</span><br><span class="line">http&#123; <span class="comment">#http块</span></span><br><span class="line">    server &#123; <span class="comment">#server快</span></span><br><span class="line">        location &#123; <span class="comment">#location快</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2、每块的结构功能</p><p>  (1)、全局块: 配置影响nginx全局的指令。一般有运行nginx服务器的用户组，nginx进程pid存放路径，日志存放路径，配置文件引入，允许生成worker process数等。</p><p>  (2)、events块: 配置影响nginx服务器或与用户的网络连接。有每个进程的最大连接数，选取哪种事件驱动模型处理连接请求，是否允许同时接受多个网路连接，  开启多个网络连接序列化等</p><p>  (3)、http块: 可以配置多个server,配置代理、缓存、日志定义等能和第三方模块的配置。如文件引入，mime-type定义，日志自定义，是否使用sendfile传输文件，连接超时时间，单连接请求数等。 </p><p>  (4)、server块: 配置虚拟主机的相关参数，一个http中可以有多个server。</p><p>  (5)、location块: 配置请求的路由，以及各种页面的处理情况。</p><p>3、nginx配置文件详细的解释</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">########### 每个指令必须有分号结束。#################</span></span><br><span class="line"><span class="comment">#user administrator administrators;  #配置用户或者组，默认为nobody nobody。</span></span><br><span class="line"><span class="comment">#worker_processes 2;  #允许生成的进程数，默认为1</span></span><br><span class="line"><span class="comment">#pid /nginx/pid/nginx.pid;   #指定nginx进程运行文件存放地址</span></span><br><span class="line">error_log <span class="built_in">log</span>/error.log debug;  <span class="comment">#制定日志路径，级别。这个设置可以放入全局块，http块，server块，级别以此为：debug|info|notice|warn|error|crit|alert|emerg</span></span><br><span class="line">events &#123;</span><br><span class="line">    accept_mutex on;   <span class="comment">#设置网路连接序列化，防止惊群现象发生，默认为on</span></span><br><span class="line">    multi_accept on;  <span class="comment">#设置一个进程是否同时接受多个网络连接，默认为off</span></span><br><span class="line">    <span class="comment">#use epoll;      #事件驱动模型，select|poll|kqueue|epoll|resig|/dev/poll|eventport</span></span><br><span class="line">    worker_connections  1024;    <span class="comment">#最大连接数，默认为512</span></span><br><span class="line">&#125;</span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types;   <span class="comment">#文件扩展名与文件类型映射表</span></span><br><span class="line">    default_type  application/octet-stream; <span class="comment">#默认文件类型，默认为text/plain</span></span><br><span class="line">    <span class="comment">#access_log off; #取消服务日志    </span></span><br><span class="line">    log_format myFormat <span class="string">&#x27;$remote_addr–$remote_user [$time_local] $request $status $body_bytes_sent $http_referer $http_user_agent $http_x_forwarded_for&#x27;</span>; <span class="comment">#自定义格式</span></span><br><span class="line">    access_log <span class="built_in">log</span>/access.log myFormat;  <span class="comment">#combined为日志格式的默认值</span></span><br><span class="line">    sendfile on;   <span class="comment">#允许sendfile方式传输文件，默认为off，可以在http块，server块，location块。</span></span><br><span class="line">    sendfile_max_chunk 100k;  <span class="comment">#每个进程每次调用传输数量不能大于设定的值，默认为0，即不设上限。</span></span><br><span class="line">    keepalive_timeout 65;  <span class="comment">#连接超时时间，默认为75s，可以在http，server，location块。</span></span><br><span class="line"></span><br><span class="line">    upstream mysvr &#123;   </span><br><span class="line">      server 127.0.0.1:7878;</span><br><span class="line">      server 192.168.10.121:3333 backup;  <span class="comment">#热备</span></span><br><span class="line">    &#125;</span><br><span class="line">    error_page 404 https://www.baidu.com; <span class="comment">#错误页</span></span><br><span class="line">    server &#123;</span><br><span class="line">        keepalive_requests 120; <span class="comment">#单连接请求上限次数。</span></span><br><span class="line">        listen       4545;   <span class="comment">#监听端口</span></span><br><span class="line">        server_name  127.0.0.1;   <span class="comment">#监听地址       </span></span><br><span class="line">        location  ~*^.+$ &#123;       <span class="comment">#请求的url过滤，正则匹配，~为区分大小写，~*为不区分大小写。</span></span><br><span class="line">           <span class="comment">#root path;  #根目录</span></span><br><span class="line">           <span class="comment">#index vv.txt;  #设置默认页</span></span><br><span class="line">           proxy_pass  http://mysvr;  <span class="comment">#请求转向mysvr 定义的服务器列表</span></span><br><span class="line">           deny 127.0.0.1;  <span class="comment">#拒绝的ip</span></span><br><span class="line">           allow 172.18.5.54; <span class="comment">#允许的ip           </span></span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="以上都是没有成功之前的一些文案，下面是一些在配置过程中出现并且了解的知识点"><a href="#以上都是没有成功之前的一些文案，下面是一些在配置过程中出现并且了解的知识点" class="headerlink" title="以上都是没有成功之前的一些文案，下面是一些在配置过程中出现并且了解的知识点"></a>以上都是没有成功之前的一些文案，下面是一些在配置过程中出现并且了解的知识点</h2><p>在配置使用命令行进行的文件结构中<br>etc/nginx下面有两个主要引入的配置文件：<br>1.第一个是conf.d中的文件<br>2.第二个是site-enables中的文件，其中site-enable的文件就是对site-avalible中的文件的链接，直接对site-avalible中的文件进行修改就可以<br>在初始化的时候，conf.d中是没有default文件的，需要自己写相关的配置文件，这个的格式可以copy site-enables中的文件。之前一直在徘徊的问题也是这个，使用的格式一直不对。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># You should look at the following URL&#x27;s in order to grasp a solid understanding</span></span><br><span class="line"><span class="comment"># of Nginx configuration files in order to fully unleash the power of Nginx.</span></span><br><span class="line"><span class="comment"># https://www.nginx.com/resources/wiki/start/</span></span><br><span class="line"><span class="comment"># https://www.nginx.com/resources/wiki/start/topics/tutorials/config_pitfalls/</span></span><br><span class="line"><span class="comment"># https://wiki.debian.org/Nginx/DirectoryStructure</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># In most cases, administrators will remove this file from sites-enabled/ and</span></span><br><span class="line"><span class="comment"># leave it as reference inside of sites-available where it will continue to be</span></span><br><span class="line"><span class="comment"># updated by the nginx packaging team.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This file will automatically load configuration files provided by other</span></span><br><span class="line"><span class="comment"># applications, such as Drupal or Wordpress. These applications will be made</span></span><br><span class="line"><span class="comment"># available underneath a path with that package name, such as /drupal8.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Default server configuration</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">server &#123;</span><br><span class="line">        listen 80 default_server;</span><br><span class="line">        listen [::]:80 default_server;</span><br><span class="line">        <span class="comment"># SSL configuration</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment"># listen 443 ssl default_server;</span></span><br><span class="line">        <span class="comment"># listen [::]:443 ssl default_server;</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment"># Note: You should disable gzip for SSL traffic.</span></span><br><span class="line">        <span class="comment"># See: https://bugs.debian.org/773332</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment"># Read up on ssl_ciphers to ensure a secure configuration.</span></span><br><span class="line">        <span class="comment"># See: https://bugs.debian.org/765782</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment"># Self signed certs generated by the ssl-cert package</span></span><br><span class="line">        <span class="comment"># Don&#x27;t use them in a production server!</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment"># include snippets/snakeoil.conf;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#这里很关键，要定在文件渲染之后对目录中，后面要求对location是/，以后直接用地址加端口号就可以访问了</span></span><br><span class="line">        root /home/web/hexo/public;</span><br><span class="line">          <span class="comment"># Add index.php to the list if you are using PHP</span></span><br><span class="line">        index index.html index.htm index.nginx-debian.html;</span><br><span class="line"></span><br><span class="line">        server_name **.**.***.**;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">                <span class="comment"># First attempt to serve request as file, then</span></span><br><span class="line">                <span class="comment"># as directory, then fall back to displaying a 404.</span></span><br><span class="line">                try_files <span class="variable">$uri</span> <span class="variable">$uri</span>/ =404;</span><br><span class="line">        &#125;</span><br><span class="line">  <span class="comment"># pass PHP scripts to FastCGI server</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment">#location ~ \.php$ &#123;</span></span><br><span class="line">        <span class="comment">#       include snippets/fastcgi-php.conf;</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment">#       # With php-fpm (or other unix sockets):</span></span><br><span class="line">        <span class="comment">#       fastcgi_pass unix:/var/run/php/php7.4-fpm.sock;</span></span><br><span class="line">        <span class="comment">#       # With php-cgi (or other tcp sockets):</span></span><br><span class="line">        <span class="comment">#       fastcgi_pass 127.0.0.1:9000;</span></span><br><span class="line">        <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># deny access to .htaccess files, if Apache&#x27;s document root</span></span><br><span class="line">        <span class="comment"># concurs with nginx&#x27;s one</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment">#location ~ /\.ht &#123;</span></span><br><span class="line">        <span class="comment">#       deny all;</span></span><br><span class="line">        <span class="comment">#&#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果不使用如下的情况应该可以直接在nginx中进行配置<br>这样直接地址加端口就能映射到整个文件了</p><h3 id="防火墙相关代码"><a href="#防火墙相关代码" class="headerlink" title="防火墙相关代码"></a>防火墙相关代码</h3><p>在linux中访问nginx，默认是不能访问的，因为防火墙问题，我们需要开放一部分端口号<br>查看开放的端口号:<br>开启防火墙<br>systemctl start firewalld<br>关闭防火墙<br>systemctl stop firewalld<br>查看端口开放情况<br>firewall-cmd –list-ports<br>开放某个特定的端口<br>firewall-cmd –zone=public –add-port=81/tcp –permanent<br>关闭某个特定的端口<br>firewall-cmd –remove-port=80/tcp –permanent<br>更改配置后重启防火墙<br>systemctl reload firewalld</p><h3 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h3><p>1.准备工作<br>(1)准备两台 tomcat 服务器，一台 8080，一台 8081<br>(2)在两台 tomcat 里面 webapps 目录中，创建名称是 edu 文件夹，在 edu 文件夹中创建 页面 a.html，用于测试<br>2.在 nginx 的配置文件中进行负载均衡的配置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">upstream myserver &#123;</span><br><span class="line">    server ***.***.***.***:port1</span><br><span class="line">    server ***.***.***.***:port2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen 80</span><br><span class="line">    server_name ********</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://myserver;</span><br><span class="line">        root </span><br><span class="line">        index </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.nginx 分配服务器策略<br>第一种 轮询(默认)<br>每个请求按时间顺序逐一分配到不同的后端服务器，如果后端服务器 down 掉，能自动剔除。<br>第二种 weight<br>weight 代表权重默认为 1,权重越高被分配的客户端越多<br>第三种 ip_hash<br>每个请求按访问 ip 的 hash 结果分配，这样每个访客固定访问一个后端服务器<br>第四种 fair(第三方) 按后端服务器的响应时间来分配请求，响应时间短的优先分配。</p><p>以后详细学习动态均衡和动静分离时继续更新</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;nginx使用教程&quot;&gt;&lt;a href=&quot;#nginx使用教程&quot; class=&quot;headerlink&quot; title=&quot;nginx使用教程&quot;&gt;&lt;/a&gt;nginx使用教程&lt;/h1&gt;&lt;p&gt;本nginx是在Ubuntu20.04系统下运行的&lt;br&gt;nginx version</summary>
      
    
    
    
    <category term="教程" scheme="http://example.com/categories/%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="nginx" scheme="http://example.com/tags/nginx/"/>
    
  </entry>
  
  <entry>
    <title>ai-study</title>
    <link href="http://example.com/2021/05/11/ai-study/"/>
    <id>http://example.com/2021/05/11/ai-study/</id>
    <published>2021-05-10T16:33:46.511Z</published>
    <updated>2021-05-10T16:42:10.665Z</updated>
    
    <content type="html"><![CDATA[<h2 id="关于ai学习的一些历程"><a href="#关于ai学习的一些历程" class="headerlink" title="关于ai学习的一些历程"></a>关于ai学习的一些历程</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;关于ai学习的一些历程&quot;&gt;&lt;a href=&quot;#关于ai学习的一些历程&quot; class=&quot;headerlink&quot; title=&quot;关于ai学习的一些历程&quot;&gt;&lt;/a&gt;关于ai学习的一些历程&lt;/h2&gt;</summary>
      
    
    
    
    <category term="学习记录" scheme="http://example.com/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
    
    
    <category term="ai" scheme="http://example.com/tags/ai/"/>
    
  </entry>
  
  <entry>
    <title>ai-environment</title>
    <link href="http://example.com/2021/05/11/ai-env/"/>
    <id>http://example.com/2021/05/11/ai-env/</id>
    <published>2021-05-10T16:21:53.517Z</published>
    <updated>2021-05-15T12:03:57.284Z</updated>
    
    <content type="html"><![CDATA[<h2 id="这个文档主要与pytorch等机器学习等python或者其他库等配置方法，和在服务器中的使用方法"><a href="#这个文档主要与pytorch等机器学习等python或者其他库等配置方法，和在服务器中的使用方法" class="headerlink" title="这个文档主要与pytorch等机器学习等python或者其他库等配置方法，和在服务器中的使用方法"></a>这个文档主要与pytorch等机器学习等python或者其他库等配置方法，和在服务器中的使用方法</h2><ol><li>用nvidia-smi来查看显卡的信息</li><li>接着用yum来安装python</li><li>安装annocoda环境，先下载包，然后bash即可，会自动帮你配置好文件</li><li>export PATH=”/home/‘user’/anaconda3/bin:$PATH”</li><li>conda create -n pytorch python=3.8</li><li>source activate pytorch</li><li>接着创建虚拟环境，用pip安装你想要的扩展包即可，注意与自己的cuda环境版本要一致</li><li>上传模型文件以及其他的训练材料</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;这个文档主要与pytorch等机器学习等python或者其他库等配置方法，和在服务器中的使用方法&quot;&gt;&lt;a href=&quot;#这个文档主要与pytorch等机器学习等python或者其他库等配置方法，和在服务器中的使用方法&quot; class=&quot;headerlink&quot; tit</summary>
      
    
    
    
    <category term="命令技巧" scheme="http://example.com/categories/%E5%91%BD%E4%BB%A4%E6%8A%80%E5%B7%A7/"/>
    
    
    <category term="ai" scheme="http://example.com/tags/ai/"/>
    
  </entry>
  
  <entry>
    <title>unix-order</title>
    <link href="http://example.com/2021/05/10/unix-order/"/>
    <id>http://example.com/2021/05/10/unix-order/</id>
    <published>2021-05-10T09:05:38.661Z</published>
    <updated>2021-05-15T08:03:03.546Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Unix"><a href="#Unix" class="headerlink" title="Unix"></a>Unix</h1><h1 id="Unix-常用命令技巧（可配-linux-大部分命令）"><a href="#Unix-常用命令技巧（可配-linux-大部分命令）" class="headerlink" title="Unix 常用命令技巧（可配 linux 大部分命令）"></a>Unix 常用命令技巧（可配 linux 大部分命令）</h1><p>pwd：print work directory 打印工作目录</p><p>ls：查看当前文件夹文件 </p><p>​    -l：查看文件     -al：查看左右文件（包含以小数点开头的隐藏文件） </p><p>​    ls | more 分页展示当前文件夹中的所有文件</p><p>​    ls python* 这个就是使用正则表达式来搜索</p><p>​    ls | grep “python”将前面查询结果交由后面继续查询</p><p>​        ｜是管道符号，将前面命令结果交由后面的命令执行</p><p>​    ln：给文件建立链接</p><p>​            使用方式：ln -s 【源文件】【链接名】注意只能建立文件类型的链接不能建立文件夹类型的链接</p><p>​            【option】：-s：建立链接</p><p>​                       -f：存在覆盖，不存在则覆盖</p><p>find ：搜索查询文件</p><p>​        find 查询路径 选项 参数</p><p>​            比如find . -name “python”查询当前目录下所有名字中有关键字python的文件</p><p>​            各种查询方式可以从man中找到</p><p>cd：改变文件夹位置</p><p>​    加~回车 或者 直接回车：直接进入用户当前主目录</p><p>​    加/回车：进入用户根目录</p><p>who：查看当前系统的用户</p><p>​    whoami：当前登录用户</p><p>man：查看命令帮助手册</p><p>–help：查看命令选项(也就是放在指令后面)</p><p>history：罗列在终端窗口中操作的命令</p><p>touch：在当前文件目录中创建一个空文件</p><p>mkdir：在当前文件目录中创建一个文件夹，mkdir -p 可以用/来进行连续嵌套，比如mkdir -p /微信/user</p><p>tree：列出在本目录下，文件的树形图</p><p>rm：删除一个文件    rmdir：删除一个文件夹    rm -rf连级删除文件夹（文件夹里面        的东西也会删掉）。rm -rf * 删除当前文件夹中的所有文件，执行之前使pwd确认一下当前文件夹是哪个，一般在unix删除大量日志信息时，要确定在哪个文件夹。rm -rf /：永远不要执行，这个是删除根目录。</p><p>tar：打包解压命令 </p><p>​        -c：打包，将多个文件打包成一个文件，这个文件后缀名：.tar</p><p>​        -x ：解包，将.tar文件拆分成原始的多个文件</p><p>​        -t：查看.tar包中的所有文件</p><p>​        -v：展示操作过程信息</p><p>​        -f：不需要确认直接操作</p><p>​        tar -cvf ：文件.tar 要打包的多个文件列表</p><p>​        tar -tvf：查看包内多个文件</p><p>​        打包文件是为了统一整理文件，方便文件在移动/传输中最大程度的保证文件不损坏</p><p>gzip：压缩命令，压缩文件的名称，后缀名一般是：gz    通常情况下，和tar命令一起使用，tar命令打包文件，gzip压缩文件，得到.tar.tz，默认压缩的话会直接覆盖原文件</p><p>​        gzip -d：解压缩文件</p><p>​    tar -xzvf 文件.tar.gz：解压缩.tar.gz文件，解压的同时拆包，得到具体文件</p><p>bzip2：压缩解压命令，和tar命令一般结合使用，tar用于文件打包，bzip2用于压缩，压缩后的：.tar.bz2为后缀</p><p>zip | unzip :压缩与解压缩 </p><p>​        zip后缀：.zip 使用方法，zip 压缩后的名称 具体压缩文件列表; </p><p>​        unzip 使用方法：直接unzip 文件名</p><p>cp：copy复制文件的指令 具体使用方式为：cp 【当前文件夹内文件】 【复制到指定目录】</p><p>mv：剪切文件指令</p><p>more：查看文件中的内容</p><p>cat：直接查看文件内容，全部内容直接展示。</p><p>tail -f ：查看文件末尾的内容，默认展示10行内容，并且持续监视文件，如果文件中新增数据也会直接展示到屏幕中，通常用于监控内容的变化 </p><p>head：查看文件开头内容</p><p>grep：搜索查询的命令可以从文件中，列出包含查询文本的行</p><p>top：查看Unix/linux中的任务管理器</p><p>​        查看当前系统中正在运行的软件进程，以  及他们消耗的系统资源信息</p><p>ps：查看系统中的所有进程【process status进程状态】</p><p>​        通常情况下我们使用下面的命令</p><p>​        ps -ef | grep [具体进程名字]</p><p>kill：杀死进程</p><p>​    kill 进程编号</p><p>!! ：将上一个命令执行一下</p><p>!【所匹配符】：执行的最近的能匹配到的匹配符的指令</p><p>文件权限：<br><img src="/images/image-20210309220647820.png" alt="image-20210309220647820.png"></p><p>​在unix中对于用户来说只能操作自己目录下的文件</p><p><img src="/images/image-20210309221210006.png" alt="image-20210309221210006"></p><p><img src="/images/image-20210309221541565.png" alt="image-20210309221541565"></p><p><img src="/images/image-20210309222228349.png" alt="image-20210309222228349"></p><h2 id="mac-本地文件与服务器Linux文件之间的相互传输"><a href="#mac-本地文件与服务器Linux文件之间的相互传输" class="headerlink" title="mac 本地文件与服务器Linux文件之间的相互传输"></a>mac 本地文件与服务器Linux文件之间的相互传输</h2><p>可以简单用scp 命令来实现</p><p>查看scp帮助：sup -h</p><p>输出信息如下：usage: scp [-12346BCEpqrv] [-c cipher] [-F ssh_config] [-i identity_file]  [-l limit] [-o ssh_option] [-P port] [-S program][[user@]host1:]file1 … [[user@]host2:]file2</p><p>OPTIONS：</p><p>-v  显示进度。可以用来查看连接、认证、或是配置错误</p><p>-P 选择端口</p><p>-r 复制目录</p><p>1、从本地将文件传输到服务器<br>scp[本地文件的路径]   [服务器用户名]@[服务器地址]:[服务器上存放文件的路径]</p><p>scp /Users/mac/Desktop/test.txt <a href="mailto:&#x72;&#x6f;&#111;&#x74;&#x40;&#x31;&#x39;&#50;&#x2e;&#49;&#54;&#x38;&#46;&#x31;&#x2e;&#49;">&#x72;&#x6f;&#111;&#x74;&#x40;&#x31;&#x39;&#50;&#x2e;&#49;&#54;&#x38;&#46;&#x31;&#x2e;&#49;</a>:/root</p><p>2、从本地将文件夹传输到服务器<br>scp -r[本地文件的路径]   [服务器用户名]@[服务器地址]:[服务器上存放文件的路径]</p><p>scp -r /Users/mac/Desktop/test <a href="mailto:&#114;&#x6f;&#x6f;&#116;&#64;&#x31;&#x39;&#x32;&#46;&#x31;&#x36;&#x38;&#46;&#x31;&#46;&#49;">&#114;&#x6f;&#x6f;&#116;&#64;&#x31;&#x39;&#x32;&#46;&#x31;&#x36;&#x38;&#46;&#x31;&#46;&#49;</a>:/root</p><p>3、将服务器上的文件传输到本地<br>scp [服务器用户名]@[服务器地址]:[服务器上存放文件的路径]   [本地文件的路径]</p><p>scp <a href="mailto:&#x72;&#x6f;&#111;&#x74;&#64;&#49;&#57;&#50;&#x2e;&#x31;&#x36;&#56;&#46;&#49;&#x2e;&#49;">&#x72;&#x6f;&#111;&#x74;&#64;&#49;&#57;&#50;&#x2e;&#x31;&#x36;&#56;&#46;&#49;&#x2e;&#49;</a>:/root/default/test.txt /Users/mac/Desktop</p><p>4、将服务器上的文件夹传输到本地<br>scp -r [服务器用户名]@[服务器地址]:[服务器上存放文件的路径]   [本地文件的路径]</p><p>scp -r <a href="mailto:&#114;&#111;&#x6f;&#116;&#x40;&#x31;&#57;&#x32;&#x2e;&#49;&#54;&#56;&#x2e;&#49;&#x2e;&#49;">&#114;&#111;&#x6f;&#116;&#x40;&#x31;&#57;&#x32;&#x2e;&#49;&#54;&#56;&#x2e;&#49;&#x2e;&#49;</a>:/root/default/test /Users/mac/Desktop</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Unix&quot;&gt;&lt;a href=&quot;#Unix&quot; class=&quot;headerlink&quot; title=&quot;Unix&quot;&gt;&lt;/a&gt;Unix&lt;/h1&gt;&lt;h1 id=&quot;Unix-常用命令技巧（可配-linux-大部分命令）&quot;&gt;&lt;a href=&quot;#Unix-常用命令技巧（可配-lin</summary>
      
    
    
    
    <category term="命令技巧" scheme="http://example.com/categories/%E5%91%BD%E4%BB%A4%E6%8A%80%E5%B7%A7/"/>
    
    
    <category term="unix" scheme="http://example.com/tags/unix/"/>
    
  </entry>
  
  <entry>
    <title>hello hexo</title>
    <link href="http://example.com/2021/05/08/hello-world/"/>
    <id>http://example.com/2021/05/08/hello-world/</id>
    <published>2021-05-08T08:52:00.684Z</published>
    <updated>2021-05-10T16:42:05.309Z</updated>
    
    <content type="html"><![CDATA[<p>本篇文章介绍了如何使用hexo博客以及配置相关的内容（包括统计插件，评论插件等）：</p><h2 id="安装并发布hexo"><a href="#安装并发布hexo" class="headerlink" title="安装并发布hexo"></a>安装并发布hexo</h2><p>安装hexo：npm install -g hexo-cli<br>检查是否安装成功：hexo -v<br>初始化网址：hexo init<br>接着输入 npm install 来安装这个网址所需要的依赖插件：npm install<br>生成静态网页：hexo g<br>开启本地服务器：hexo s<br>自动部署插件：npm install hexo-deployer-git  –save<br>自动更新文件：hexo clean &amp;&amp; hexo g &amp;&amp; hexo d<br>Hexo常用命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hexo new <span class="string">&quot;一个新的文章&quot;</span>    <span class="comment">#这是创建新的文章的命令</span></span><br><span class="line">hexo g    <span class="comment">#生成静态网页</span></span><br><span class="line">hexo s    <span class="comment">#启动本地服务</span></span><br><span class="line">hexo d    <span class="comment">#部署到github或别地方</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a><br>More info: <a href="https://hexo.io/docs/server.html">Server</a><br>More info: <a href="https://hexo.io/docs/generating.html">Generating</a><br>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p><h2 id="配置统计信息"><a href="#配置统计信息" class="headerlink" title="配置统计信息"></a>配置统计信息</h2><p>然后接下来就是配置一下如何进行在线观看人数的配置<br>我们会使用到LeanCloud进行移动应用的配置<br>1.注册创建一个leanCloud的应用<br>2.配置LeanCloud<br>进入新创建好的应用，点击存储，这时需要创建名为Counter的class用来存储访问博客的数据，例如：访问次数，最新访问时间等信息。class类名必须为Counter，主要为了与next主题相兼容，否则无法接收到相关数据。为了避免后续因为权限的问题导致次数统计显示不正常，ACL权限选择无限制（所有人可读可写）<br>3.​ 在所有应用中获取当前新建应用的app_id和app_key<br>4.修改博客根目录-&gt;themes-&gt;next-&gt;_config.yml文件，app_id和app_key是上图获取到的，找到如下代码替换app_id和app_key并将enable改为true，代码如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Show number of visitors to each article.</span></span><br><span class="line"><span class="comment"># You can visit https://leancloud.cn get AppID and AppKey.</span></span><br><span class="line">leancloud_visitors:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">  app_id: <span class="comment">#AppID</span></span><br><span class="line">  app_key: <span class="comment">#AppKey //注意这里一定要是字符串类型的</span></span><br></pre></td></tr></table></figure><p>配置完成后重新部署hexo即可</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo generate</span><br><span class="line">hexo deploy</span><br></pre></td></tr></table></figure><p>5.此处配置完成之后还要配置一下卜算子的这个主题插件的配置<br>对于leancloud_count，你必须设置appid、appkey；对于busuanzi_count，你只需要开启它即可。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># post_count</span></span><br><span class="line">leancloud_count:</span><br><span class="line">+   <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">+   appid: <span class="string">&#x27;dXz&#x27;</span></span><br><span class="line">+    appkey: <span class="string">&#x27;wzG&#x27;</span></span><br><span class="line">    like_post:</span><br><span class="line">        <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">+   visit_post:</span><br><span class="line">        <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">    topN_post: </span><br><span class="line">        <span class="built_in">enable</span>: <span class="literal">true</span> <span class="comment">#param1 for topN_post</span></span><br><span class="line">        <span class="built_in">limit</span>: 10 <span class="comment">#param2 for topN_post</span></span><br><span class="line">busuanzi_count:</span><br><span class="line">    <span class="built_in">enable</span>: <span class="literal">true</span></span><br></pre></td></tr></table></figure><p><a href="https://notes.wanghao.work/2015-10-21-%E4%B8%BANexT%E4%B8%BB%E9%A2%98%E6%B7%BB%E5%8A%A0%E6%96%87%E7%AB%A0%E9%98%85%E8%AF%BB%E9%87%8F%E7%BB%9F%E8%AE%A1%E5%8A%9F%E8%83%BD.html">参考资料</a></p><h2 id="配置评论插件Gitalk"><a href="#配置评论插件Gitalk" class="headerlink" title="配置评论插件Gitalk"></a>配置评论插件Gitalk</h2><p>下面我们开始配置评论插件Gitalk<br>1.首先我们需要设置一个github仓库用来存放评论<br>2.然后用申请一个Oauth application<a href="https://github.com/settings/applications/new">链接</a>申请之后拿到Client ID以及Client secrets<br>3.然后对hexo中themes中对_config.yml进行简单的配置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">gitalk:</span><br><span class="line">    <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">    clientID: <span class="string">&#x27;&#x27;</span> </span><br><span class="line">    clientSecret: <span class="string">&#x27;&#x27;</span> </span><br><span class="line">    repo: [之前创建的仓库名]</span><br><span class="line">    owner: 创建的仓库的owner</span><br><span class="line">    admin: 创建的仓库的admin</span><br><span class="line">    distractionFreeMode: <span class="literal">true</span></span><br><span class="line">    <span class="comment">#去除 more、index.html、?query=123等格式尾部 </span></span><br><span class="line">    hrefTrimend: <span class="string">&#x27;#.*$,\\?.*$,index.html$&#x27;</span> </span><br></pre></td></tr></table></figure><p>注意的是这个可能建立之后不能立即评论，需要初始化一下评论，简单的来说就是管理员和仓库owner都登陆一遍差不多就可以了<br><a href="https://github.com/gitalk/gitalk/issues">issues</a></p><h2 id="live2d插件（动态2d效果）"><a href="#live2d插件（动态2d效果）" class="headerlink" title="live2d插件（动态2d效果）"></a>live2d插件（动态2d效果）</h2><p>1.安装Live2D插件：npm install –save hexo-helper-live2d<br>然后安装喜欢的动画：npm install xxxxxx<br>下面是安装的列表</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">live2d-widget-model-chitose</span><br><span class="line">live2d-widget-model-epsilon2_1</span><br><span class="line">live2d-widget-model-gf</span><br><span class="line">live2d-widget-model-haru/01 (use npm install --save live2d-widget-model-haru)</span><br><span class="line">live2d-widget-model-haru/02 (use npm install --save live2d-widget-model-haru)</span><br><span class="line">live2d-widget-model-haruto</span><br><span class="line">live2d-widget-model-hibiki</span><br><span class="line">live2d-widget-model-hijiki</span><br><span class="line">live2d-widget-model-izumi</span><br><span class="line">live2d-widget-model-koharu</span><br><span class="line">live2d-widget-model-miku</span><br><span class="line">live2d-widget-model-ni-j</span><br><span class="line">live2d-widget-model-nico</span><br><span class="line">live2d-widget-model-nietzsche</span><br><span class="line">live2d-widget-model-nipsilon</span><br><span class="line">live2d-widget-model-nito</span><br><span class="line">live2d-widget-model-shizuku</span><br><span class="line">live2d-widget-model-tororo</span><br><span class="line">live2d-widget-model-tsumiki</span><br><span class="line">live2d-widget-model-unitychan</span><br><span class="line">live2d-widget-model-wanko</span><br><span class="line">live2d-widget-model-z16</span><br></pre></td></tr></table></figure><p>2.修改配置文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Live2D动画</span></span><br><span class="line">live2d:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">  scriptFrom: <span class="built_in">local</span></span><br><span class="line">  pluginRootPath: live2dw/</span><br><span class="line">  pluginJsPath: lib/</span><br><span class="line">  pluginModelPath: assets/</span><br><span class="line">  tagMode: <span class="literal">false</span></span><br><span class="line">  debug: <span class="literal">false</span></span><br><span class="line">  model:</span><br><span class="line">    use: live2d-widget-model-shizuku</span><br><span class="line">  display:</span><br><span class="line">    position: right </span><br><span class="line">    width: 150</span><br><span class="line">    height: 300</span><br><span class="line">  mobile:</span><br><span class="line">    show: <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>主要参数说明</p><p>enable //是否使用<br>model:<br>use: live2d-widget-model-shizuku //要使用的模型名称<br>display:<br>position: right //显示的位置<br>width: 150 //宽度<br>height: 150 //高度<br>mobile:<br>show: true //移动端是否显示</p><h2 id="其他使用的命令"><a href="#其他使用的命令" class="headerlink" title="其他使用的命令"></a>其他使用的命令</h2><p>创建分类页：hexo new page categories </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">title: categories</span><br><span class="line">date: 2019-03-30 19:25:34</span><br><span class="line">+ layout: categories</span><br><span class="line">+ <span class="built_in">type</span>: categories</span><br></pre></td></tr></table></figure><p>创建标签页：hexo new page tags</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">title: tags</span><br><span class="line">date: 2019-03-30 19:25:34</span><br><span class="line">+ layout: tags</span><br><span class="line">+ <span class="built_in">type</span>: tags</span><br></pre></td></tr></table></figure><p>创建关于页：hexo new page about</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">title: about</span><br><span class="line">date: 2019-03-30 19:25:34</span><br><span class="line">+ layout: about</span><br><span class="line">+ <span class="built_in">type</span>: about</span><br></pre></td></tr></table></figure><p>创建相册页：hexo new page gallery</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">title: gallery</span><br><span class="line">date: 2019-03-30 19:25:34</span><br><span class="line">+ layout: gallery</span><br><span class="line">+ <span class="built_in">type</span>: gallery</span><br></pre></td></tr></table></figure><p>打开文件data.json（Annie/source/plugin/gallerypage/data.json）, 按照json语法在数组[……]中添加gallery的图片数据，请设置合适的eWidth、eHeight的值。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">&#123;&#125;, </span><br><span class="line">&#123;</span><br><span class="line">        <span class="string">&quot;thumbnail&quot;</span>: <span class="string">&quot;https://img.jpg&quot;</span>,     //小图路径</span><br><span class="line">        <span class="string">&quot;enlarged&quot;</span>: <span class="string">&quot;https://img.jpg&quot;</span>, //大图路径（可与小图一致）</span><br><span class="line">        <span class="string">&quot;title&quot;</span>: <span class="string">&quot;百里守约&quot;</span>,//图片标题</span><br><span class="line">        <span class="string">&quot;categories&quot;</span>: [&#123;</span><br><span class="line">                <span class="string">&quot;id&quot;</span>: 9,//根据id来进行分类</span><br><span class="line">                <span class="string">&quot;title&quot;</span>: <span class="string">&quot;百里玄策&quot;</span>,</span><br><span class="line">                <span class="string">&quot;photo_count&quot;</span>: 41787, //可忽略</span><br><span class="line">                <span class="string">&quot;links&quot;</span>: &#123;//可忽略</span><br><span class="line">                    <span class="string">&quot;self&quot;</span>: <span class="string">&quot;https://img.jpg&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;photos&quot;</span>: <span class="string">&quot;https://img.jpg&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">&quot;tWidth&quot;</span>: 800.6130030959752,//小图相对宽度</span><br><span class="line">        <span class="string">&quot;tHeight&quot;</span>: 500,   //小图相对高度</span><br><span class="line">        <span class="string">&quot;eWidth&quot;</span>: 3630,   //大图相对宽度</span><br><span class="line">        <span class="string">&quot;eHeight&quot;</span>: 2907   //大图相对高度</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;&#125;</span><br><span class="line"> ]</span><br></pre></td></tr></table></figure><p>当然，你可以将该文件data.json移至其他目录，相应地修改路径gallery_data</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># gallery page</span></span><br><span class="line"><span class="comment"># gallery_format: natural | square</span></span><br><span class="line">gallery_format: natural</span><br><span class="line"><span class="comment"># one time to load 4 rows or other count, 0 to load img automatically when scrolling.(0,1,2,3,4,5,6......)</span></span><br><span class="line">gallery_limit: 0</span><br><span class="line"><span class="comment"># data url</span></span><br><span class="line">+ gallery_data: plugin/gallerypage/data.json</span><br></pre></td></tr></table></figure><p>创建站内搜索：npm install hexo-generator-search-zip –save<br>编辑站点目录下的_config.yml，添加如下语句</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">search:</span><br><span class="line">  path: search.json</span><br><span class="line">  zipPath: search.zip</span><br><span class="line">  versionPath: searchVersion.txt</span><br><span class="line">  field: post</span><br><span class="line">  <span class="comment">#field: post, page or all（3个可选参数）</span></span><br></pre></td></tr></table></figure><p>编辑主题目录下的_config.yml，添加如下语句</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Local search</span></span><br><span class="line"><span class="comment"># Dependencies: https://github.com/flashlab/hexo-generator-search</span></span><br><span class="line">local_search:</span><br><span class="line">    <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">    <span class="comment"># if auto, trigger search by changing input</span></span><br><span class="line">    <span class="comment"># if manual, trigger search by pressing enter key or search button</span></span><br><span class="line">    trigger: auto</span><br><span class="line">    <span class="comment"># show top n results per article, show all results by setting to -1</span></span><br><span class="line">    top_n_per_article: 2</span><br></pre></td></tr></table></figure><h2 id="下面描述一下博客md文档生成时会出现的错误"><a href="#下面描述一下博客md文档生成时会出现的错误" class="headerlink" title="下面描述一下博客md文档生成时会出现的错误"></a>下面描述一下博客md文档生成时会出现的错误</h2><p>1.首先是图片问题，可能出现图片上传然后渲染不出来的情况<br>  下面是解决方法<br>  第一步（简单配置）：<br>  （1）把主页配置文件_config.yml 里的post_asset_folder:这个选项设置为true<br>  （2）在你的hexo目录下执行这样一句话npm install hexo-asset-image –save，这是下载安装一个可以上传本地图片的插件<br>  （3）等待一小段时间后，再运行hexo n “xxxx”来生成md博文时，/source/_posts文件夹内除了xxxx.md文件还有一个同名的文件夹<br>  第二步（如何使用）：<br>  （4）最后在xxxx.md中想引入图片时，先把图片复制到xxxx这个文件夹中，然后只需要在xxxx.md中按照markdown的格式引入图片：!【你想输入的替代文字】(xxxx/图片名.jpg)<br>  注意： xxxx是这个md文件的名字，也是同名文件夹的名字。只需要有文件夹名字即可，不需要有什么绝对路径。你想引入的图片就只需要放入xxxx这个文件夹内就好了，很像引用相对路径<br>  （5）最后检查一下，hexo g生成页面后，进入public\2017\02\26\index.html文件中查看相关字段，可以发现，html标签内的语句是<br>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;2017/02/26/xxxx/图片名.jpg&quot;&gt;</span><br></pre></td></tr></table></figure><br>  而不是<br>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;xxxx/图片名.jpg&quot;&gt;</span><br></pre></td></tr></table></figure><br>  这很重要，关乎你的网页是否可以真正加载你想插入的图片。</p><p>  经过一段时间的努力，上面的操作没有奏效qwq<br>  于是开始想用另外一种方法，将图片存放在云上以http网址访问，这种还没开始弄，以后弄好后会更新<br>  另外一种比较朴素的方法是将所要使用的图片保存到source目录下，新建一个images文件夹，然后在这里面存放，经过编译以后，这个文件会直接放在根目录上面，以后调用的时候直接用 /images/xxx.jpg 的路径就可以了</p><p>【完结撒花】</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;本篇文章介绍了如何使用hexo博客以及配置相关的内容（包括统计插件，评论插件等）：&lt;/p&gt;
&lt;h2 id=&quot;安装并发布hexo&quot;&gt;&lt;a href=&quot;#安装并发布hexo&quot; class=&quot;headerlink&quot; title=&quot;安装并发布hexo&quot;&gt;&lt;/a&gt;安装并发布hexo&lt;</summary>
      
    
    
    
    <category term="教程" scheme="http://example.com/categories/%E6%95%99%E7%A8%8B/"/>
    
    
    <category term="hexo" scheme="http://example.com/tags/hexo/"/>
    
  </entry>
  
</feed>
